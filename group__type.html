<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.9.5"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>QuEST: Data structures</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="style.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
        <script type="text/javascript" src="jquery.smartmenus.js"></script>
        <!-- SmartMenus jQuery Bootstrap Addon -->
        <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
        <!-- SmartMenus jQuery plugin -->
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand"><img alt="Logo" src="logo.png"/></a>
                    <a class="navbar-brand"><b>QuEST</b> v3.6.0<br>The Quantum Exact Simulation Toolkit</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Data structures</div></div>
</div><!--header-->
<div class="contents">

<p>Precision-agnostic types and data structures for representing numbers, quantum states, and operators.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplex.html">Complex</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents one complex number.  <a href="structComplex.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a 2x2 matrix of complex numbers.  <a href="structComplexMatrix2.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplexMatrix4.html">ComplexMatrix4</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a 4x4 matrix of complex numbers.  <a href="structComplexMatrix4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a general 2^N by 2^N matrix of complex numbers.  <a href="structComplexMatrixN.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDiagonalOp.html">DiagonalOp</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a diagonal complex operator on the full Hilbert state of a <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code>.  <a href="structDiagonalOp.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPauliHamil.html">PauliHamil</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represent any Hermitian operator.  <a href="structPauliHamil.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structQuESTEnv.html">QuESTEnv</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about the environment the program is running in.  <a href="structQuESTEnv.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structQureg.html">Qureg</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a system of qubits.  <a href="structQureg.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code>.  <a href="structSubDiagonalOp.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVector.html">Vector</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a 3-vector of real numbers.  <a href="structVector.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga3cf635d2b2e57226c8d5a777f513367e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga3cf635d2b2e57226c8d5a777f513367e">fromComplex</a>(comp)&#160;&#160;&#160;<a class="el" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a>(comp.real, comp.imag)</td></tr>
<tr class="memdesc:ga3cf635d2b2e57226c8d5a777f513367e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a <a class="el" href="structComplex.html" title="Represents one complex number.">Complex</a> struct to a qcomp native type.  <a href="group__type.html#ga3cf635d2b2e57226c8d5a777f513367e">More...</a><br /></td></tr>
<tr class="separator:ga3cf635d2b2e57226c8d5a777f513367e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga927beeee2ba3b110f33ebb440c154ae2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">getStaticComplexMatrixN</a>(numQubits,  re,  im)</td></tr>
<tr class="memdesc:ga927beeee2ba3b110f33ebb440c154ae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> struct which lives in the stack and so does not need freeing, but cannot be returned beyond the calling scope.  <a href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">More...</a><br /></td></tr>
<tr class="separator:ga927beeee2ba3b110f33ebb440c154ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad863c5878a01051a2726ce94bf365428"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a></td></tr>
<tr class="memdesc:gad863c5878a01051a2726ce94bf365428"><td class="mdescLeft">&#160;</td><td class="mdescRight">A precision-agnostic operator-overloaded complex number type.  <a href="group__type.html#gad863c5878a01051a2726ce94bf365428">More...</a><br /></td></tr>
<tr class="separator:gad863c5878a01051a2726ce94bf365428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7740e349b4f8bae6451547680f0ce2d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;&#160;&#160;double</td></tr>
<tr class="memdesc:ga7740e349b4f8bae6451547680f0ce2d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">A precision-agnostic floating point number, as determined by <a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c">QuEST_PREC</a>.  <a href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">More...</a><br /></td></tr>
<tr class="separator:ga7740e349b4f8bae6451547680f0ce2d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga626676e623baa3de702c185736018b2c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c">QuEST_PREC</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga626676e623baa3de702c185736018b2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the precision of <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> and <a class="el" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a> floating-point numbers, and hence the numerical precision of <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code>.  <a href="group__type.html#ga626676e623baa3de702c185736018b2c">More...</a><br /></td></tr>
<tr class="separator:ga626676e623baa3de702c185736018b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab54c5a1ea720830a7ee394d03fb9f4e9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gab54c5a1ea720830a7ee394d03fb9f4e9">toComplex</a>(scalar)&#160;&#160;&#160;((<a class="el" href="structComplex.html">Complex</a>) {.real = creal(scalar), .imag = cimag(scalar)})</td></tr>
<tr class="memdesc:gab54c5a1ea720830a7ee394d03fb9f4e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a <a class="el" href="structComplex.html" title="Represents one complex number.">Complex</a> struct, which can be passed to the QuEST API, from a qcomp.  <a href="group__type.html#gab54c5a1ea720830a7ee394d03fb9f4e9">More...</a><br /></td></tr>
<tr class="separator:gab54c5a1ea720830a7ee394d03fb9f4e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga9c91c41aa42ae537995e89ffc616afe1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a> { <a class="el" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a> =0
, <a class="el" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a> =1
 }</td></tr>
<tr class="memdesc:ga9c91c41aa42ae537995e89ffc616afe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for specifying how the bits in sub-register computational basis states are mapped to indices in functions like <a class="el" href="group__operator.html#ga467f517abd18dbc3d6fced84c6589161" title="Induces a phase change upon each amplitude of qureg, determined by the passed exponential polynomial ...">applyPhaseFunc()</a>.  <a href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">More...</a><br /></td></tr>
<tr class="separator:ga9c91c41aa42ae537995e89ffc616afe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c703cf89629e4e9c7023cd402d67028"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a> { <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a> =0
, <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c">PAULI_X</a> =1
, <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd">PAULI_Y</a> =2
, <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a> =3
 }</td></tr>
<tr class="memdesc:ga1c703cf89629e4e9c7023cd402d67028"><td class="mdescLeft">&#160;</td><td class="mdescRight">Codes for specifying Pauli operators.  <a href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">More...</a><br /></td></tr>
<tr class="separator:ga1c703cf89629e4e9c7023cd402d67028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7d869b117ba5024d6b84938e8cdfc65"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gaa7d869b117ba5024d6b84938e8cdfc65">phaseFunc</a> { <br />
&#160;&#160;<a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e">NORM</a> =0
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1">SCALED_NORM</a> =1
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043">INVERSE_NORM</a> =2
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2">SCALED_INVERSE_NORM</a> =3
, <br />
&#160;&#160;<a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a> =4
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4">PRODUCT</a> =5
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93">SCALED_PRODUCT</a> =6
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556">INVERSE_PRODUCT</a> =7
, <br />
&#160;&#160;<a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb">SCALED_INVERSE_PRODUCT</a> =8
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91">DISTANCE</a> =9
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4">SCALED_DISTANCE</a> =10
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0">INVERSE_DISTANCE</a> =11
, <br />
&#160;&#160;<a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227">SCALED_INVERSE_DISTANCE</a> =12
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a> =13
, <a class="el" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a> =14
<br />
 }</td></tr>
<tr class="memdesc:gaa7d869b117ba5024d6b84938e8cdfc65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for specifying named phase functions.  <a href="group__type.html#gaa7d869b117ba5024d6b84938e8cdfc65">More...</a><br /></td></tr>
<tr class="separator:gaa7d869b117ba5024d6b84938e8cdfc65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabd07eee133dcd4e6ae7c2d2ce4c42978"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structQureg.html">Qureg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gabd07eee133dcd4e6ae7c2d2ce4c42978">createCloneQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:gabd07eee133dcd4e6ae7c2d2ce4c42978"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> which is an exact clone of the passed qureg, which can be either a state-vector or a density matrix.  <a href="group__type.html#gabd07eee133dcd4e6ae7c2d2ce4c42978">More...</a><br /></td></tr>
<tr class="separator:gabd07eee133dcd4e6ae7c2d2ce4c42978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga815103261fb22ea9690e1427571df00e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e">createComplexMatrixN</a> (int numQubits)</td></tr>
<tr class="memdesc:ga815103261fb22ea9690e1427571df00e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions like <a class="el" href="group__unitary.html#ga20bf9b8a71b8a3ee4651e9497e6d1f4f" title="Apply a general multi-qubit unitary (including a global phase factor) with any number of target qubit...">multiQubitUnitary()</a> and <a class="el" href="group__operator.html#ga358e7094a98851afa86d27f0147e32a1" title="Apply a general N-by-N matrix, which may be non-unitary, on any number of target qubits.">applyMatrixN()</a>.  <a href="group__type.html#ga815103261fb22ea9690e1427571df00e">More...</a><br /></td></tr>
<tr class="separator:ga815103261fb22ea9690e1427571df00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93e55b6650b408abb30a1d4a8bce757c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structQureg.html">Qureg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c">createDensityQureg</a> (int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:ga93e55b6650b408abb30a1d4a8bce757c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a density matrix <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> object representing a set of qubits which can enter noisy and mixed states.  <a href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c">More...</a><br /></td></tr>
<tr class="separator:ga93e55b6650b408abb30a1d4a8bce757c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaebf896dd8d5eeaf9fd896f6cc8e334fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">createDiagonalOp</a> (int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:gaebf896dd8d5eeaf9fd896f6cc8e334fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> representing a diagonal operator on the full Hilbert space of a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>.  <a href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">More...</a><br /></td></tr>
<tr class="separator:gaebf896dd8d5eeaf9fd896f6cc8e334fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa86572b44755646858d6b0292d53cc15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gaa86572b44755646858d6b0292d53cc15">createDiagonalOpFromPauliHamilFile</a> (char *fn, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:gaa86572b44755646858d6b0292d53cc15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and initialiases a diagonal operator from the Z Pauli Hamiltonian encoded in file with filename <code>fn</code>.  <a href="group__type.html#gaa86572b44755646858d6b0292d53cc15">More...</a><br /></td></tr>
<tr class="separator:gaa86572b44755646858d6b0292d53cc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35b28710877c462927366fa602e591cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb">createPauliHamil</a> (int numQubits, int numSumTerms)</td></tr>
<tr class="memdesc:ga35b28710877c462927366fa602e591cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.  <a href="group__type.html#ga35b28710877c462927366fa602e591cb">More...</a><br /></td></tr>
<tr class="separator:ga35b28710877c462927366fa602e591cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa77376c5e3518186eb085f37826d6008"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008">createPauliHamilFromFile</a> (char *fn)</td></tr>
<tr class="memdesc:gaa77376c5e3518186eb085f37826d6008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a <code><a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></code> instance, a real-weighted sum of products of Pauli operators, populated with the data in filename <code>fn</code>.  <a href="group__type.html#gaa77376c5e3518186eb085f37826d6008">More...</a><br /></td></tr>
<tr class="separator:gaa77376c5e3518186eb085f37826d6008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ba2c3388dd64d9348c3b091852d36d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga8ba2c3388dd64d9348c3b091852d36d4">createQuESTEnv</a> (void)</td></tr>
<tr class="memdesc:ga8ba2c3388dd64d9348c3b091852d36d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the QuEST execution environment.  <a href="group__type.html#ga8ba2c3388dd64d9348c3b091852d36d4">More...</a><br /></td></tr>
<tr class="separator:ga8ba2c3388dd64d9348c3b091852d36d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3392816c0643414165c2f5caeec17df0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structQureg.html">Qureg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0">createQureg</a> (int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:ga3392816c0643414165c2f5caeec17df0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a state-vector <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> object representing a set of qubits which will remain in a pure state.  <a href="group__type.html#ga3392816c0643414165c2f5caeec17df0">More...</a><br /></td></tr>
<tr class="separator:ga3392816c0643414165c2f5caeec17df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3129b2a427fb0ea52387b63088d0068b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b">createSubDiagonalOp</a> (int numQubits)</td></tr>
<tr class="memdesc:ga3129b2a427fb0ea52387b63088d0068b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> representing a diagonal operator which can act upon a subset of the qubits in a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>.  <a href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b">More...</a><br /></td></tr>
<tr class="separator:ga3129b2a427fb0ea52387b63088d0068b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9df2f3d86be4a6e9aad481665e5e6753"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga9df2f3d86be4a6e9aad481665e5e6753">destroyComplexMatrixN</a> (<a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a> matr)</td></tr>
<tr class="memdesc:ga9df2f3d86be4a6e9aad481665e5e6753"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> instance created with <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a>  <a href="group__type.html#ga9df2f3d86be4a6e9aad481665e5e6753">More...</a><br /></td></tr>
<tr class="separator:ga9df2f3d86be4a6e9aad481665e5e6753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c59f45fab56708f687b4104ee99bcd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga2c59f45fab56708f687b4104ee99bcd1">destroyDiagonalOp</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:ga2c59f45fab56708f687b4104ee99bcd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys a <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> created with <a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a>, freeing its memory.  <a href="group__type.html#ga2c59f45fab56708f687b4104ee99bcd1">More...</a><br /></td></tr>
<tr class="separator:ga2c59f45fab56708f687b4104ee99bcd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1c8ed909b33bd55ae680901006051b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6">destroyPauliHamil</a> (<a class="el" href="structPauliHamil.html">PauliHamil</a> hamil)</td></tr>
<tr class="memdesc:gac1c8ed909b33bd55ae680901006051b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> instance, created with either <a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a> or <a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a>.  <a href="group__type.html#gac1c8ed909b33bd55ae680901006051b6">More...</a><br /></td></tr>
<tr class="separator:gac1c8ed909b33bd55ae680901006051b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeff624226629d7063a8a776958a4f991"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gaeff624226629d7063a8a776958a4f991">destroyQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:gaeff624226629d7063a8a776958a4f991"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the QuEST environment.  <a href="group__type.html#gaeff624226629d7063a8a776958a4f991">More...</a><br /></td></tr>
<tr class="separator:gaeff624226629d7063a8a776958a4f991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e1e6ad3254892edc2ee08712ea9d692"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga8e1e6ad3254892edc2ee08712ea9d692">destroyQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:ga8e1e6ad3254892edc2ee08712ea9d692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>, freeing its memory.  <a href="group__type.html#ga8e1e6ad3254892edc2ee08712ea9d692">More...</a><br /></td></tr>
<tr class="separator:ga8e1e6ad3254892edc2ee08712ea9d692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6eaa131f0b73a53f1218e19ce4825ac3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga6eaa131f0b73a53f1218e19ce4825ac3">destroySubDiagonalOp</a> (<a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a> op)</td></tr>
<tr class="memdesc:ga6eaa131f0b73a53f1218e19ce4825ac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> instance created with <a class="el" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b" title="Creates a SubDiagonalOp representing a diagonal operator which can act upon a subset of the qubits in...">createSubDiagonalOp()</a>.  <a href="group__type.html#ga6eaa131f0b73a53f1218e19ce4825ac3">More...</a><br /></td></tr>
<tr class="separator:ga6eaa131f0b73a53f1218e19ce4825ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga429f1b90b3ef06c786dec8c7f0eda4ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga429f1b90b3ef06c786dec8c7f0eda4ce">initComplexMatrixN</a> (<a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a> m, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> real[][1&lt;&lt; m.numQubits], <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> imag[][1&lt;&lt; m.numQubits])</td></tr>
<tr class="memdesc:ga429f1b90b3ef06c786dec8c7f0eda4ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> instance to have the passed <code>real</code> and <code>imag</code> values.  <a href="group__type.html#ga429f1b90b3ef06c786dec8c7f0eda4ce">More...</a><br /></td></tr>
<tr class="separator:ga429f1b90b3ef06c786dec8c7f0eda4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12a6c59ebbfba8bdb9453a4138027d46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46">initDiagonalOp</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *real, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imag)</td></tr>
<tr class="memdesc:ga12a6c59ebbfba8bdb9453a4138027d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overwrites the entire <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> <code>op</code> with the given <code>real</code> and <code>imag</code> complex elements.  <a href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46">More...</a><br /></td></tr>
<tr class="separator:ga12a6c59ebbfba8bdb9453a4138027d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ecd67e0de9efcbbe37afbad28a8ffad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad">initDiagonalOpFromPauliHamil</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op, <a class="el" href="structPauliHamil.html">PauliHamil</a> hamil)</td></tr>
<tr class="memdesc:ga2ecd67e0de9efcbbe37afbad28a8ffad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates the diagonal operator <code>op</code> to be equivalent to the given Pauli Hamiltonian <code>hamil</code>, assuming <code>hamil</code> contains only <code>PAULI_Z</code> operators.  <a href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad">More...</a><br /></td></tr>
<tr class="separator:ga2ecd67e0de9efcbbe37afbad28a8ffad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbe6701dda1d49168f2f23253e370a7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a">initPauliHamil</a> (<a class="el" href="structPauliHamil.html">PauliHamil</a> hamil, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *coeffs, enum <a class="el" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a> *codes)</td></tr>
<tr class="memdesc:gadbe6701dda1d49168f2f23253e370a7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> instance <code>hamil</code> with the given term coefficients and Pauli codes (one for every qubit in every term).  <a href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a">More...</a><br /></td></tr>
<tr class="separator:gadbe6701dda1d49168f2f23253e370a7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafabb15a6c1cf49f8ecb67e1f35c77c1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e">setDiagonalOpElems</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op, long long int startInd, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *real, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imag, long long int numElems)</td></tr>
<tr class="memdesc:gafabb15a6c1cf49f8ecb67e1f35c77c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modifies a subset (starting at index <code>startInd</code>, and ending at index <code>startInd</code> <b>+</b> <code>numElems</code>) of the elements in <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> <code>op</code> with the given complex numbers (passed as <code>real</code> and <code>imag</code> components).  <a href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e">More...</a><br /></td></tr>
<tr class="separator:gafabb15a6c1cf49f8ecb67e1f35c77c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab75d5cdc622d2778bad24e3a8130aab9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9">syncDiagonalOp</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="memdesc:gab75d5cdc622d2778bad24e3a8130aab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the GPU memory with the current values in <code>op.real</code> and <code>op.imag</code>.  <a href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9">More...</a><br /></td></tr>
<tr class="separator:gab75d5cdc622d2778bad24e3a8130aab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Precision-agnostic types and data structures for representing numbers, quantum states, and operators. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga3cf635d2b2e57226c8d5a777f513367e" name="ga3cf635d2b2e57226c8d5a777f513367e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3cf635d2b2e57226c8d5a777f513367e">&#9670;&#160;</a></span>fromComplex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define fromComplex</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">comp</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a>(comp.real, comp.imag)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a <a class="el" href="structComplex.html" title="Represents one complex number.">Complex</a> struct to a qcomp native type. </p>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

</div>
</div>
<a id="ga927beeee2ba3b110f33ebb440c154ae2" name="ga927beeee2ba3b110f33ebb440c154ae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga927beeee2ba3b110f33ebb440c154ae2">&#9670;&#160;</a></span>getStaticComplexMatrixN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define getStaticComplexMatrixN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">numQubits, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">re, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">im&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_function" href="QuEST__common_8c.html#ad67cb67877c941189b0de2c2e67e2026">bindArraysToStackComplexMatrixN</a>( \</div>
<div class="line">        numQubits, \</div>
<div class="line">        (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>[1&lt;&lt;numQubits][1&lt;&lt;numQubits]) UNPACK_ARR re, \</div>
<div class="line">        (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>[1&lt;&lt;numQubits][1&lt;&lt;numQubits]) UNPACK_ARR im, \</div>
<div class="line">        (<span class="keywordtype">double</span>*[1&lt;&lt;numQubits]) {NULL}, (<span class="keywordtype">double</span>*[1&lt;&lt;numQubits]) {NULL} \</div>
<div class="line">    )</div>
<div class="ttc" id="aQuEST__common_8c_html_ad67cb67877c941189b0de2c2e67e2026"><div class="ttname"><a href="QuEST__common_8c.html#ad67cb67877c941189b0de2c2e67e2026">bindArraysToStackComplexMatrixN</a></div><div class="ttdeci">ComplexMatrixN bindArraysToStackComplexMatrixN(int numQubits, qreal re[][1&lt;&lt; numQubits], qreal im[][1&lt;&lt; numQubits], qreal **reStorage, qreal **imStorage)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00649">QuEST_common.c:649</a></div></div>
<div class="ttc" id="agroup__type_html_ga7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC.</div></div>
</div><!-- fragment -->
<p>Creates a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> struct which lives in the stack and so does not need freeing, but cannot be returned beyond the calling scope. </p>
<p >That is, the .real and .imag arrays of the returned <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> live in the stack as opposed to that returned by <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a> (which live in the heap). Note the real and imag components must be wrapped in paranthesis, e.g. </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structComplexMatrixN.html">ComplexMatrixN</a> u = <a class="code hl_define" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">getStaticComplexMatrixN</a>(1, ({{1,2},{3,4}}), ({{0}}));</div>
<div class="ttc" id="agroup__type_html_ga927beeee2ba3b110f33ebb440c154ae2"><div class="ttname"><a href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">getStaticComplexMatrixN</a></div><div class="ttdeci">#define getStaticComplexMatrixN(numQubits, re, im)</div><div class="ttdoc">Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l06097">QuEST.h:6097</a></div></div>
<div class="ttc" id="astructComplexMatrixN_html"><div class="ttname"><a href="structComplexMatrixN.html">ComplexMatrixN</a></div><div class="ttdoc">Represents a general 2^N by 2^N matrix of complex numbers.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00186">QuEST.h:187</a></div></div>
</div><!-- fragment --><p >Here is an example of an incorrect usage, since a 'local' <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> cannot leave the calling scope (otherwise inducing dangling pointers): </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structComplexMatrixN.html">ComplexMatrixN</a> getMyMatrix(<span class="keywordtype">void</span>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_define" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">getStaticComplexMatrixN</a>(1, ({{1,2},{3,4}}), ({{0}}));</div>
<div class="line">}</div>
</div><!-- fragment --><p >This function is actually a single-line anonymous macro, so can be safely invoked within arguments to other functions, e.g. </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__unitary.html#ga20bf9b8a71b8a3ee4651e9497e6d1f4f">multiQubitUnitary</a>(</div>
<div class="line">    qureg, (<span class="keywordtype">int</span>[]) {0}, 1, </div>
<div class="line">    <a class="code hl_define" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">getStaticComplexMatrixN</a>(1, ({{1,0},{0,1}}), ({{0}}))</div>
<div class="line">);</div>
<div class="ttc" id="agroup__unitary_html_ga20bf9b8a71b8a3ee4651e9497e6d1f4f"><div class="ttname"><a href="group__unitary.html#ga20bf9b8a71b8a3ee4651e9497e6d1f4f">multiQubitUnitary</a></div><div class="ttdeci">void multiQubitUnitary(Qureg qureg, int *targs, int numTargs, ComplexMatrixN u)</div><div class="ttdoc">Apply a general multi-qubit unitary (including a global phase factor) with any number of target qubit...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00304">QuEST.c:304</a></div></div>
</div><!-- fragment --><p >The returned <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> can be accessed and modified in the same way as that returned by <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a>, e.g. </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structComplexMatrixN.html">ComplexMatrixN</a> u = <a class="code hl_define" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2">getStaticComplexMatrixN</a>(3, ({{0}}), ({{0}}));</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;8; j++)</div>
<div class="line">        u.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>[i][j] = .1;</div>
<div class="ttc" id="astructComplexMatrixN_html_a446e8a077597e4f76049d547df0c9738"><div class="ttname"><a href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">ComplexMatrixN::real</a></div><div class="ttdeci">qreal ** real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00189">QuEST.h:189</a></div></div>
</div><!-- fragment --><p> <br  />
 </p><blockquote class="doxtable">
<p >&zwj;Note that the first argument <code>numQubits</code> must be a literal. </p>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;This macro is only callable in C, since it invokes the function <a class="el" href="QuEST__common_8c.html#ad67cb67877c941189b0de2c2e67e2026">bindArraysToStackComplexMatrixN()</a> which is only callable in C. </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a></li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8h_source.html#l06097">6097</a> of file <a class="el" href="QuEST_8h_source.html">QuEST.h</a>.</p>

</div>
</div>
<a id="gad863c5878a01051a2726ce94bf365428" name="gad863c5878a01051a2726ce94bf365428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad863c5878a01051a2726ce94bf365428">&#9670;&#160;</a></span>qcomp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define qcomp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A precision-agnostic operator-overloaded complex number type. </p>
<p ><br  />
 This is a complex analog of <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> and is of single, double or quad precision depending on the value of <a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c">QuEST_PREC</a>. It resolves to the native complex type provided by &lt;complex.h&gt; for both C99 and C++11, so can be used with operators. It can be constructed with <code><a class="el" href="group__type.html#gad863c5878a01051a2726ce94bf365428" title="A precision-agnostic operator-overloaded complex number type.">qcomp(real, imag)</a></code>.</p>
<p >For example, in C, </p><div class="fragment"><div class="line"><a class="code hl_define" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a> x = 2 + 3i;</div>
<div class="line">x -= 3.2*x; </div>
<div class="ttc" id="agroup__type_html_gad863c5878a01051a2726ce94bf365428"><div class="ttname"><a href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a></div><div class="ttdeci">#define qcomp</div><div class="ttdoc">A precision-agnostic operator-overloaded complex number type.</div></div>
</div><!-- fragment --><p> and in C++, </p><div class="fragment"><div class="line"><a class="code hl_define" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a> x = <a class="code hl_define" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a>(2, 3);</div>
<div class="line">x -= 3*x; </div>
</div><!-- fragment --><p >Assuming <code>QuEST_PREC=4</code>, qcomp will be 'complex long double' in C and 'complex&lt;long double&gt;' in C++.</p>
<p >Can be converted to/from <a class="el" href="structComplex.html">Complex</a>, the struct accepted by the QuEST interface, using <a class="el" href="group__type.html#gab54c5a1ea720830a7ee394d03fb9f4e9">toComplex</a> and <a class="el" href="group__type.html#ga3cf635d2b2e57226c8d5a777f513367e">fromComplex</a>.</p>
<dl class="section author"><dt>Authors</dt><dd>Randy Meyers and Dr. Thomas Plum (created C &amp; C++ agnosticism) </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones (created precision agnosticism) </dd></dl>

</div>
</div>
<a id="ga7740e349b4f8bae6451547680f0ce2d6" name="ga7740e349b4f8bae6451547680f0ce2d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7740e349b4f8bae6451547680f0ce2d6">&#9670;&#160;</a></span>qreal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define qreal&#160;&#160;&#160;double</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A precision-agnostic floating point number, as determined by <a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c">QuEST_PREC</a>. </p>
<p >Is a single, double or quad precision float when <a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c">QuEST_PREC</a> is 1, 2 or 4 respectively.</p>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd>
<dd>
Tyson Jones (doc) </dd></dl>

</div>
</div>
<a id="ga626676e623baa3de702c185736018b2c" name="ga626676e623baa3de702c185736018b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga626676e623baa3de702c185736018b2c">&#9670;&#160;</a></span>QuEST_PREC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QuEST_PREC&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the precision of <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> and <a class="el" href="group__type.html#gad863c5878a01051a2726ce94bf365428">qcomp</a> floating-point numbers, and hence the numerical precision of <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code>. </p>
<p ><a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a> can be set as a preprocessor macro during compilation, or by editing its definition in <a class="el" href="QuEST__precision_8h.html" title="Sets the QuEST constants which depend on the variable (during compilation) state-vector precision.">QuEST_precision.h</a>. <br  />
The possible values are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a>   </th><th class="markdownTableHeadNone">qreal   </th><th class="markdownTableHeadNone">sizeof(qreal)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">4 bytes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone">8 bytes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone"><code>long double</code>   </td><td class="markdownTableBodyNone">16 bytes   </td></tr>
</table>
<blockquote class="doxtable">
<p >&zwj;Note that quad precision (<a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a> <b>= 4 </b>) is not compatible with most GPUs. </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a> and <a class="el" href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c" title="Creates a density matrix Qureg object representing a set of qubits which can enter noisy and mixed st...">createDensityQureg()</a> for the total memory costs of creating registers under these precisions.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd>
<dd>
Tyson Jones (doc) </dd></dl>

</div>
</div>
<a id="gab54c5a1ea720830a7ee394d03fb9f4e9" name="gab54c5a1ea720830a7ee394d03fb9f4e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab54c5a1ea720830a7ee394d03fb9f4e9">&#9670;&#160;</a></span>toComplex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define toComplex</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">scalar</td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="structComplex.html">Complex</a>) {.real = creal(scalar), .imag = cimag(scalar)})</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a <a class="el" href="structComplex.html" title="Represents one complex number.">Complex</a> struct, which can be passed to the QuEST API, from a qcomp. </p>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga9c91c41aa42ae537995e89ffc616afe1" name="ga9c91c41aa42ae537995e89ffc616afe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c91c41aa42ae537995e89ffc616afe1">&#9670;&#160;</a></span>bitEncoding</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags for specifying how the bits in sub-register computational basis states are mapped to indices in functions like <a class="el" href="group__operator.html#ga467f517abd18dbc3d6fced84c6589161" title="Induces a phase change upon each amplitude of qureg, determined by the passed exponential polynomial ...">applyPhaseFunc()</a>. </p>
<ul>
<li><code>UNSIGNED</code> means the bits encode an unsigned integer, hence  <p class="formulaDsp">
\[ 
\begin{aligned}
    |00\rangle &amp; \rightarrow \, 0 \\
    |01\rangle &amp; \rightarrow \, 1 \\
    |10\rangle &amp; \rightarrow \, 2 \\
    |11\rangle &amp; \rightarrow \, 3
\end{aligned}
\]
</p>
</li>
<li><code>TWOS_COMPLEMENT</code> means the bits encode a signed integer through <a href="https://en.wikipedia.org/wiki/Two%27s_complement">two's complement</a>, such that  <p class="formulaDsp">
\[ 
\begin{aligned}
    |000\rangle &amp; \rightarrow \, 0 \\
    |001\rangle &amp; \rightarrow \, 1 \\
    |010\rangle &amp; \rightarrow \, 2 \\
    |011\rangle &amp; \rightarrow \, 3 \\
    |100\rangle &amp; \rightarrow \,-4 \\
    |101\rangle &amp; \rightarrow \,-3 \\
    |110\rangle &amp; \rightarrow \,-2 \\
    |111\rangle &amp; \rightarrow \,-1
\end{aligned}
\]
</p>
 <blockquote class="doxtable">
<p >&zwj;Remember that the qubits specified within a sub-register, and their ordering (least to most significant) determine the bits of a computational basis state, before intrepretation as an encoding of an integer. </p>
</blockquote>
</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae" name="gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae"></a>UNSIGNED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c" name="gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c"></a>TWOS_COMPLEMENT&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="QuEST_8h_source.html#l00271">271</a> of file <a class="el" href="QuEST_8h_source.html">QuEST.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  271</span>{<a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a>=0, <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a>=1};</div>
<div class="ttc" id="agroup__type_html_gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae"><div class="ttname"><a href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a></div><div class="ttdeci">@ UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00271">QuEST.h:271</a></div></div>
<div class="ttc" id="agroup__type_html_gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c"><div class="ttname"><a href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a></div><div class="ttdeci">@ TWOS_COMPLEMENT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00271">QuEST.h:271</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1c703cf89629e4e9c7023cd402d67028" name="ga1c703cf89629e4e9c7023cd402d67028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c703cf89629e4e9c7023cd402d67028">&#9670;&#160;</a></span>pauliOpType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Codes for specifying Pauli operators. </p>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a" name="gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a"></a>PAULI_I&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c" name="gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c"></a>PAULI_X&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd" name="gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd"></a>PAULI_Y&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf" name="gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf"></a>PAULI_Z&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="QuEST_8h_source.html#l00096">96</a> of file <a class="el" href="QuEST_8h_source.html">QuEST.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   96</span>{<a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a>=0, <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c">PAULI_X</a>=1, <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd">PAULI_Y</a>=2, <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a>=3};</div>
<div class="ttc" id="agroup__type_html_gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf"><div class="ttname"><a href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a></div><div class="ttdeci">@ PAULI_Z</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
<div class="ttc" id="agroup__type_html_gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd"><div class="ttname"><a href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd">PAULI_Y</a></div><div class="ttdeci">@ PAULI_Y</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
<div class="ttc" id="agroup__type_html_gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a"><div class="ttname"><a href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a></div><div class="ttdeci">@ PAULI_I</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
<div class="ttc" id="agroup__type_html_gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c"><div class="ttname"><a href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c">PAULI_X</a></div><div class="ttdeci">@ PAULI_X</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa7d869b117ba5024d6b84938e8cdfc65" name="gaa7d869b117ba5024d6b84938e8cdfc65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7d869b117ba5024d6b84938e8cdfc65">&#9670;&#160;</a></span>phaseFunc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__type.html#gaa7d869b117ba5024d6b84938e8cdfc65">phaseFunc</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags for specifying named phase functions. </p>
<p >These can be passed to functions <a class="el" href="group__operator.html#gac4df97d8c125c8cc65df720f67b2bf69" title="Induces a phase change upon each amplitude of qureg, determined by a named (and potentially multi-var...">applyNamedPhaseFunc()</a>, <a class="el" href="group__operator.html#ga2fbaec3bb21cc01f7a2a4ed2aa911ebf" title="Induces a phase change upon each amplitude of qureg, determined by a named (and potentially multi-var...">applyNamedPhaseFuncOverrides()</a>, <a class="el" href="group__operator.html#ga225b82ff8b8eed1fff312240ec70c731" title="Induces a phase change upon each amplitude of qureg, determined by a named, paramaterized (and potent...">applyParamNamedPhaseFunc()</a>, and <a class="el" href="group__operator.html#gaabd7efa3beebc9f3a525321d41a28989" title="Induces a phase change upon each amplitude of qureg, determined by a named, parameterised (and potent...">applyParamNamedPhaseFuncOverrides()</a>.</p>
<p >Norm based phase functions:</p><ul>
<li><code>NORM</code> maps state \(|x\rangle|y\rangle\dots\) to \(\sqrt{x^2 + y^2 + \dots}\)</li>
<li><code>SCALED_NORM</code> maps state \(|x\rangle|y\rangle\dots\) to \(\text{coeff} \sqrt{x^2 + y^2 + \dots}\)</li>
<li><code>INVERSE_NORM</code> maps state \(|x\rangle|y\rangle\dots\) to \(1/\sqrt{x^2 + y^2 + \dots}\)</li>
<li><code>SCALED_INVERSE_NORM</code> maps state \(|x\rangle|y\rangle\dots\) to \(\text{coeff}/\sqrt{x^2 + y^2 + \dots}\)</li>
<li><code>SCALED_INVERSE_SHIFTED_NORM</code> maps state \(|x\rangle|y\rangle\dots\) to \(\text{coeff}/\sqrt{(x-\Delta_x)^2 + (y-\Delta_y)^2 + \dots}\)</li>
</ul>
<p >Product based phase functions:</p><ul>
<li><code>PRODUCT</code> maps state \(|x\rangle|y\rangle|z\rangle\dots\) to \(x \; y \; z \dots\)</li>
<li><code>SCALED_PRODUCT</code> maps state \(|x\rangle|y\rangle|z\rangle\dots\) to \(\text{coeff} \; x \; y \; z \dots\)</li>
<li><code>INVERSE_PRODUCT</code> maps state \(|x\rangle|y\rangle|z\rangle\dots\) to \(1/(x \; y \; z \dots)\)</li>
<li><code>SCALED_INVERSE_PRODUCT</code> maps state \(|x\rangle|y\rangle|z\rangle\dots\) to \(\text{coeff}/(x \; y \; z \dots)\)</li>
</ul>
<p >Euclidean distance based phase functions:</p><ul>
<li><code>DISTANCE</code> maps state \(|x_1\rangle|x_2\rangle|y_1\rangle|y_2\rangle\dots\) to \(\sqrt{(x_1-x_2)^2 + (y_1-y_2)^2 + \dots}\)</li>
<li><code>SCALED_DISTANCE</code> maps state \(|x_1\rangle|x_2\rangle|y_1\rangle|y_2\rangle\dots\) to \(\text{coeff}\sqrt{(x_1-x_2)^2 + (y_1-y_2)^2 + \dots}\)</li>
<li><code>INVERSE_DISTANCE</code> maps state \(|x_1\rangle|x_2\rangle|y_1\rangle|y_2\rangle\dots\) to \(1/\sqrt{(x_1-x_2)^2 + (y_1-y_2)^2 + \dots}\)</li>
<li><code>SCALED_INVERSE_DISTANCE</code> maps state \(|x_1\rangle|x_2\rangle|y_1\rangle|y_2\rangle\dots\) to \(\text{coeff}/\sqrt{(x_1-x_2)^2 + (y_1-y_2)^2 + \dots}\)</li>
<li><code>SCALED_INVERSE_SHIFTED_DISTANCE</code> maps state \(|x_1\rangle|x_2\rangle|y_1\rangle|y_2\rangle\dots\) to \(\text{coeff}/\sqrt{(x_1-x_2-\Delta_x)^2 + (y_1-y_2-\Delta_y)^2 + \dots}\)</li>
<li><code>SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</code> maps state \(|x_1\rangle|x_2\rangle|y_1\rangle|y_2\rangle\dots\) to \(\text{coeff}/\sqrt{f_x \, (x_1-x_2-\Delta_x)^2 + f_y \; (y_1-y_2-\Delta_y)^2 + \dots}\)</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd>
<dd>
Richard Meister (shifted functions) </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e" name="ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e"></a>NORM&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1" name="ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1"></a>SCALED_NORM&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043" name="ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043"></a>INVERSE_NORM&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2" name="ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2"></a>SCALED_INVERSE_NORM&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7" name="ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7"></a>SCALED_INVERSE_SHIFTED_NORM&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4" name="ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4"></a>PRODUCT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93" name="ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93"></a>SCALED_PRODUCT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556" name="ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556"></a>INVERSE_PRODUCT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb" name="ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb"></a>SCALED_INVERSE_PRODUCT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91" name="ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91"></a>DISTANCE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4" name="ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4"></a>SCALED_DISTANCE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0" name="ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0"></a>INVERSE_DISTANCE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227" name="ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227"></a>SCALED_INVERSE_DISTANCE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7" name="ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7"></a>SCALED_INVERSE_SHIFTED_DISTANCE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f" name="ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f"></a>SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="QuEST_8h_source.html#l00232">232</a> of file <a class="el" href="QuEST_8h_source.html">QuEST.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>               {</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e">NORM</a>=0,     <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1">SCALED_NORM</a>=1,      <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043">INVERSE_NORM</a>=2,      <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2">SCALED_INVERSE_NORM</a>=3,      <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a>=4,</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4">PRODUCT</a>=5,  <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93">SCALED_PRODUCT</a>=6,   <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556">INVERSE_PRODUCT</a>=7,   <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb">SCALED_INVERSE_PRODUCT</a>=8,</div>
<div class="line"><span class="lineno">  235</span>    <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91">DISTANCE</a>=9, <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4">SCALED_DISTANCE</a>=10, <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0">INVERSE_DISTANCE</a>=11, <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227">SCALED_INVERSE_DISTANCE</a>=12, <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a>=13, <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a>=14</div>
<div class="line"><span class="lineno">  236</span>};</div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb">SCALED_INVERSE_PRODUCT</a></div><div class="ttdeci">@ SCALED_INVERSE_PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91">DISTANCE</a></div><div class="ttdeci">@ DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93">SCALED_PRODUCT</a></div><div class="ttdeci">@ SCALED_PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a></div><div class="ttdeci">@ SCALED_INVERSE_SHIFTED_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0">INVERSE_DISTANCE</a></div><div class="ttdeci">@ INVERSE_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1">SCALED_NORM</a></div><div class="ttdeci">@ SCALED_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a></div><div class="ttdeci">@ SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00236">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a></div><div class="ttdeci">@ SCALED_INVERSE_SHIFTED_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556">INVERSE_PRODUCT</a></div><div class="ttdeci">@ INVERSE_PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4">PRODUCT</a></div><div class="ttdeci">@ PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4">SCALED_DISTANCE</a></div><div class="ttdeci">@ SCALED_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043">INVERSE_NORM</a></div><div class="ttdeci">@ INVERSE_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e">NORM</a></div><div class="ttdeci">@ NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227">SCALED_INVERSE_DISTANCE</a></div><div class="ttdeci">@ SCALED_INVERSE_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2">SCALED_INVERSE_NORM</a></div><div class="ttdeci">@ SCALED_INVERSE_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gabd07eee133dcd4e6ae7c2d2ce4c42978" name="gabd07eee133dcd4e6ae7c2d2ce4c42978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabd07eee133dcd4e6ae7c2d2ce4c42978">&#9670;&#160;</a></span>createCloneQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structQureg.html">Qureg</a> createCloneQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> which is an exact clone of the passed qureg, which can be either a state-vector or a density matrix. </p>
<p >The returned <a class="el" href="structQureg.html">Qureg</a> will have the same dimensions as the passed <code>qureg</code> and begin in an identical quantum state. This must be destroyed by the user later with <a class="el" href="group__type.html#ga8e1e6ad3254892edc2ee08712ea9d692" title="Deallocate a Qureg, freeing its memory.">destroyQureg()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga8e1e6ad3254892edc2ee08712ea9d692" title="Deallocate a Qureg, freeing its memory.">destroyQureg()</a></li>
<li><a class="el" href="group__init.html#ga4534403b721977b669bff7bf4e37f0fb" title="Overwrite the amplitudes of targetQureg with those from copyQureg.">cloneQureg()</a></li>
<li><a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a></li>
<li><a class="el" href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c" title="Creates a density matrix Qureg object representing a set of qubits which can enter noisy and mixed st...">createDensityQureg()</a></li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>an object representing the set of qubits </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qureg</td><td>an existing <a class="el" href="structQureg.html">Qureg</a> to be cloned </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>the <a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00064">64</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span>                                                  {</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_struct" href="structQureg.html">Qureg</a> newQureg;</div>
<div class="line"><span class="lineno">   67</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a>(&amp;newQureg, qureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a>, env);</div>
<div class="line"><span class="lineno">   68</span>    newQureg.<a class="code hl_variable" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a> = qureg.<a class="code hl_variable" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a>;</div>
<div class="line"><span class="lineno">   69</span>    newQureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a> = qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div>
<div class="line"><span class="lineno">   70</span>    newQureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = qureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a>;</div>
<div class="line"><span class="lineno">   71</span>    </div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_function" href="QuEST__qasm_8c.html#aa5f05644a6cea13e00f828658bcf7a68">qasm_setup</a>(&amp;newQureg);</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_function" href="QuEST__internal_8h.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a>(newQureg, qureg);</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">return</span> newQureg;</div>
<div class="line"><span class="lineno">   75</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_a365bbb1b80cb00405c8bf1a4fa1ea8e5"><div class="ttname"><a href="QuEST__internal_8h.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a></div><div class="ttdeci">void statevec_createQureg(Qureg *qureg, int numQubits, QuESTEnv env)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01296">QuEST_cpu.c:1296</a></div></div>
<div class="ttc" id="aQuEST__internal_8h_html_aa4b77089145184d990848cd66993aa8b"><div class="ttname"><a href="QuEST__internal_8h.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a></div><div class="ttdeci">void statevec_cloneQureg(Qureg targetQureg, Qureg copyQureg)</div><div class="ttdoc">works for both statevectors and density matrices</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01611">QuEST_cpu.c:1611</a></div></div>
<div class="ttc" id="aQuEST__qasm_8c_html_aa5f05644a6cea13e00f828658bcf7a68"><div class="ttname"><a href="QuEST__qasm_8c.html#aa5f05644a6cea13e00f828658bcf7a68">qasm_setup</a></div><div class="ttdeci">void qasm_setup(Qureg *qureg)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__qasm_8c_source.html#l00056">QuEST_qasm.c:56</a></div></div>
<div class="ttc" id="astructQureg_html"><div class="ttname"><a href="structQureg.html">Qureg</a></div><div class="ttdoc">Represents a system of qubits.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00343">QuEST.h:344</a></div></div>
<div class="ttc" id="astructQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00350">QuEST.h:350</a></div></div>
<div class="ttc" id="astructQureg_html_acf78445e9435d09f44f0cc832c6aee79"><div class="ttname"><a href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">Qureg::isDensityMatrix</a></div><div class="ttdeci">int isDensityMatrix</div><div class="ttdoc">Whether this instance is a density-state representation.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00346">QuEST.h:346</a></div></div>
<div class="ttc" id="astructQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00348">QuEST.h:348</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00346">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00350">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00056">qasm_setup()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01611">statevec_cloneQureg()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01296">statevec_createQureg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00064">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga815103261fb22ea9690e1427571df00e" name="ga815103261fb22ea9690e1427571df00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga815103261fb22ea9690e1427571df00e">&#9670;&#160;</a></span>createComplexMatrixN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a> createComplexMatrixN </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions like <a class="el" href="group__unitary.html#ga20bf9b8a71b8a3ee4651e9497e6d1f4f" title="Apply a general multi-qubit unitary (including a global phase factor) with any number of target qubit...">multiQubitUnitary()</a> and <a class="el" href="group__operator.html#ga358e7094a98851afa86d27f0147e32a1" title="Apply a general N-by-N matrix, which may be non-unitary, on any number of target qubits.">applyMatrixN()</a>. </p>
<p >The returned matrix will have dimensions  </p><p class="formulaDsp">
\[
     2^{\text{numQubits}} \times 2^{\text{numQubits}},
\]
</p>
<p> stored as nested arrays <a class="el" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">ComplexMatrixN.real</a> and <a class="el" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">ComplexMatrixN.imag</a>, initialised to zero.</p>
<blockquote class="doxtable">
<p >&zwj;If your matrix will ultimately be diagonal, use <a class="el" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b" title="Creates a SubDiagonalOp representing a diagonal operator which can act upon a subset of the qubits in...">createSubDiagonalOp()</a> instead to save quadratic memory and runtime. </p>
</blockquote>
<p>Unlike a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>, the memory of a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> is always stored in RAM, and non-distributed. Hence, elements can be directly accessed and modified: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> numQubits = 5;</div>
<div class="line"><span class="keywordtype">int</span> dim = (1 &lt;&lt; numQubits);</div>
<div class="line"><a class="code hl_struct" href="structComplexMatrixN.html">ComplexMatrixN</a> m = <a class="code hl_function" href="group__type.html#ga815103261fb22ea9690e1427571df00e">createComplexMatrixN</a>(numQubits);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;dim; r++) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;dim; c++) {</div>
<div class="line">        m.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>[r][c] = rand();</div>
<div class="line">        m.<a class="code hl_variable" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>[r][c] = rand();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__type_html_ga815103261fb22ea9690e1427571df00e"><div class="ttname"><a href="group__type.html#ga815103261fb22ea9690e1427571df00e">createComplexMatrixN</a></div><div class="ttdeci">ComplexMatrixN createComplexMatrixN(int numQubits)</div><div class="ttdoc">Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01474">QuEST.c:1474</a></div></div>
<div class="ttc" id="astructComplexMatrixN_html_afde13e469a3b4f179f45e53d1ec0a7cf"><div class="ttname"><a href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">ComplexMatrixN::imag</a></div><div class="ttdeci">qreal ** imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00190">QuEST.h:190</a></div></div>
</div><!-- fragment --><p> <br  />
A <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> can be initialised in bulk using <a class="el" href="group__type.html#ga429f1b90b3ef06c786dec8c7f0eda4ce" title="Initialises a ComplexMatrixN instance to have the passed real and imag values.">initComplexMatrixN()</a>, though this is not C++ compatible.</p>
<p >Like <a class="el" href="structComplexMatrix2.html" title="Represents a 2x2 matrix of complex numbers.">ComplexMatrix2</a> and <a class="el" href="structComplexMatrix4.html" title="Represents a 4x4 matrix of complex numbers.">ComplexMatrix4</a> (which are incidentally stored in the stack), the returned <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> is safe to return from functions.</p>
<blockquote class="doxtable">
<p >&zwj;The <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> must eventually be freed using <a class="el" href="group__type.html#ga9df2f3d86be4a6e9aad481665e5e6753" title="Destroy a ComplexMatrixN instance created with createComplexMatrixN()">destroyComplexMatrixN()</a>, since it is created in the dynamic heap. One can instead use <a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2" title="Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...">getStaticComplexMatrixN()</a> to create a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> struct in the stack (which doesn't need to be later destroyed), though this may cause a stack overflow if the matrix is too large (approx 10+ qubits). </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga9df2f3d86be4a6e9aad481665e5e6753" title="Destroy a ComplexMatrixN instance created with createComplexMatrixN()">destroyComplexMatrixN()</a></li>
<li><a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2" title="Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...">getStaticComplexMatrixN()</a></li>
<li><a class="el" href="group__type.html#ga429f1b90b3ef06c786dec8c7f0eda4ce" title="Initialises a ComplexMatrixN instance to have the passed real and imag values.">initComplexMatrixN()</a></li>
<li><a class="el" href="group__operator.html#ga358e7094a98851afa86d27f0147e32a1" title="Apply a general N-by-N matrix, which may be non-unitary, on any number of target qubits.">applyMatrixN()</a></li>
<li><a class="el" href="group__unitary.html#ga20bf9b8a71b8a3ee4651e9497e6d1f4f" title="Apply a general multi-qubit unitary (including a global phase factor) with any number of target qubit...">multiQubitUnitary()</a></li>
<li><a class="el" href="group__decoherence.html#ga65b4c0944090fae78a37ba3b94811ace" title="Apply a general N-qubit Kraus map to a density matrix, as specified by at most (2N)^2 Kraus operators...">mixMultiQubitKrausMap()</a></li>
<li><a class="el" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b" title="Creates a SubDiagonalOp representing a diagonal operator which can act upon a subset of the qubits in...">createSubDiagonalOp()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>the number of qubits of which the returned <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> will correspond </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a dynamic <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> struct, that is one where the .real and .imag fields are arrays kept in the heap and must be later destroyed. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>numQubits</code> &lt;= 0</li>
<li>if the memory was not allocated successfully </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01474">1474</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1474</span>                                                    {</div>
<div class="line"><span class="lineno"> 1475</span>     <a class="code hl_function" href="QuEST__validation_8c.html#a7c8491926b4c7b4bf8e8123f4464a08e">validateNumQubitsInMatrix</a>(numQubits, __func__);</div>
<div class="line"><span class="lineno"> 1476</span> </div>
<div class="line"><span class="lineno"> 1477</span>     <span class="keywordtype">int</span> numRows = 1 &lt;&lt; numQubits;</div>
<div class="line"><span class="lineno"> 1478</span> </div>
<div class="line"><span class="lineno"> 1479</span>     <a class="code hl_struct" href="structComplexMatrixN.html">ComplexMatrixN</a> m = {</div>
<div class="line"><span class="lineno"> 1480</span>         .<a class="code hl_variable" href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">numQubits</a> = numQubits,</div>
<div class="line"><span class="lineno"> 1481</span>         .real = malloc(numRows * <span class="keyword">sizeof</span> *m.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>),</div>
<div class="line"><span class="lineno"> 1482</span>         .imag = malloc(numRows * <span class="keyword">sizeof</span> *m.<a class="code hl_variable" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>)};</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n &lt; 1&lt;&lt;numQubits; n++) {</div>
<div class="line"><span class="lineno"> 1485</span>         m.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>[n] = calloc(numRows, <span class="keyword">sizeof</span> **m.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>);</div>
<div class="line"><span class="lineno"> 1486</span>         m.<a class="code hl_variable" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>[n] = calloc(numRows, <span class="keyword">sizeof</span> **m.<a class="code hl_variable" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>);</div>
<div class="line"><span class="lineno"> 1487</span>     }</div>
<div class="line"><span class="lineno"> 1488</span>     </div>
<div class="line"><span class="lineno"> 1489</span>     <span class="comment">// error if the ComplexMatrixN was not successfully malloc&#39;ds</span></div>
<div class="line"><span class="lineno"> 1490</span>     <a class="code hl_function" href="QuEST__validation_8c.html#a6a3d99bc780707a90120a78a6e203792">validateMatrixInit</a>(m, __func__);</div>
<div class="line"><span class="lineno"> 1491</span>     </div>
<div class="line"><span class="lineno"> 1492</span>     <span class="keywordflow">return</span> m;</div>
<div class="line"><span class="lineno"> 1493</span> }</div>
<div class="ttc" id="aQuEST__validation_8c_html_a6a3d99bc780707a90120a78a6e203792"><div class="ttname"><a href="QuEST__validation_8c.html#a6a3d99bc780707a90120a78a6e203792">validateMatrixInit</a></div><div class="ttdeci">void validateMatrixInit(ComplexMatrixN matr, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00538">QuEST_validation.c:538</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_a7c8491926b4c7b4bf8e8123f4464a08e"><div class="ttname"><a href="QuEST__validation_8c.html#a7c8491926b4c7b4bf8e8123f4464a08e">validateNumQubitsInMatrix</a></div><div class="ttdeci">void validateNumQubitsInMatrix(int numQubits, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00383">QuEST_validation.c:383</a></div></div>
<div class="ttc" id="astructComplexMatrixN_html_a606f7afbc3f65a596bdca21cb43be6a8"><div class="ttname"><a href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">ComplexMatrixN::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00188">QuEST.h:188</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00190">ComplexMatrixN::imag</a>, <a class="el" href="QuEST_8h_source.html#l00188">ComplexMatrixN::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00189">ComplexMatrixN::real</a>, <a class="el" href="QuEST__validation_8c_source.html#l00538">validateMatrixInit()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00383">validateNumQubitsInMatrix()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__common_8c_source.html#l00698">densmatr_mixMultiQubitKrausMap()</a>, <a class="el" href="QuEST__common_8c_source.html#l00680">densmatr_mixTwoQubitKrausMap()</a>, and <a class="el" href="test__data__structures_8cpp_source.html#l00110">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga93e55b6650b408abb30a1d4a8bce757c" name="ga93e55b6650b408abb30a1d4a8bce757c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93e55b6650b408abb30a1d4a8bce757c">&#9670;&#160;</a></span>createDensityQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structQureg.html">Qureg</a> createDensityQureg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a density matrix <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> object representing a set of qubits which can enter noisy and mixed states. </p>
<p >Allocates space for a matrix of complex amplitudes, which assuming a single <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> floating-point number requires <b>qrealBytes</b>, requires memory  </p><p class="formulaDsp">
\[ 
     \text{qrealBytes} \times 2 \times 2^{2 \times\text{numQubits}}\;\;\text{(bytes)},
\]
</p>
<p> though there are additional memory costs in GPU and distributed modes. Notice this is the memory cost of a state-vector created with <a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a> of twice as many qubits.</p>
<p >The returned <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> begins in the zero state, as produced by <a class="el" href="group__init.html#ga2f049055d4a51d0ea4d1a43b5234dedb" title="Initialise qureg into the zero state.">initZeroState()</a>.</p>
<p >Once created, the following <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> fields are relevant in all backends:</p><ul>
<li><a class="el" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">Qureg.numQubitsRepresented</a></li>
<li><a class="el" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79" title="Whether this instance is a density-state representation.">Qureg.isDensityMatrix</a></li>
</ul>
<p >Behind the scenes, density matrice are stored as state-vectors, flattened column-wise. As such, individual amplitudes should be fetched with <a class="el" href="group__calc.html#gadca286c4ad5cde6124d4e80a7ab95a68" title="Get an amplitude from a density matrix at a given row and column.">getDensityAmp()</a>, in lieu of direct access. <br  />
 </p><blockquote class="doxtable">
<p >&zwj;<a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> <code>env</code> must be prior created with <a class="el" href="group__type.html#ga8ba2c3388dd64d9348c3b091852d36d4" title="Create the QuEST execution environment.">createQuESTEnv()</a>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md15"></a>
Serial</h3>
<p >In serial and local (non-distributed) multithreaded modes, a density matrix <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code> costs only the memory above. For example, at double precision (<a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a> <b>= 2</b>, <b>qrealBytes = 8</b>), the memory costs are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><code>numQubits</code>   </th><th class="markdownTableHeadNone">memory    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">16 MiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">12   </td><td class="markdownTableBodyNone">256 MiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">14   </td><td class="markdownTableBodyNone">4 GiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">16   </td><td class="markdownTableBodyNone">64 GiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">18   </td><td class="markdownTableBodyNone">1 TiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">16 TiB   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md16"></a>
GPU</h3>
<p >In GPU-accelerated mode, an <em>additional</em> density matrix is created in GPU memory. Therefore both RAM and VRAM must be of sufficient memory to store the state-vector, each of the size indicated in the Serial table above.</p>
<blockquote class="doxtable">
<p >&zwj;Note that many GPUs do not support quad precision <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md17"></a>
Distributed</h3>
<p >In distributed mode, the density matrix is uniformly partitioned between the <b>N</b> distributed nodes (column-wise).</p>
<blockquote class="doxtable">
<p >&zwj;Only a power-of-2 number of nodes <b>N</b> may be used (e.g. <b>N = 1, 2, 4, 8, </b>...). There must additionally be at least 1 amplitude of a density matrix stored on each node. This means one cannot create a density matrix <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> with fewer than \(\log_2(\text{N})/2\) qubits. </p>
</blockquote>
<p>Additional memory is allocated on each node for communication buffers, of size equal to the density matrix partition. Hence the total memory <em>per-node</em> required is:  </p><p class="formulaDsp">
\[ 
     2 \times \text{qrealBytes} \times 2 \times 2^{2\times\text{numQubits}}/N  \;\;\text{(bytes)},
\]
</p>
<p >For example, at double precision (<a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a> <b>= 2</b>, <b>qrealBytes = 8</b>), the memory costs are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><code>numQubits</code>   </th><th class="markdownTableHeadNone" colspan="5">memory per node    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><b>N = 2</b>   </td><td class="markdownTableBodyNone"><b>N = 4</b>   </td><td class="markdownTableBodyNone"><b>N = 8</b>   </td><td class="markdownTableBodyNone"><b>N = 16</b>   </td><td class="markdownTableBodyNone"><b>N = 32</b>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">16 MiB   </td><td class="markdownTableBodyNone">8 MiB   </td><td class="markdownTableBodyNone">4 MiB   </td><td class="markdownTableBodyNone">2 MiB   </td><td class="markdownTableBodyNone">1 MiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">15   </td><td class="markdownTableBodyNone">16 GiB   </td><td class="markdownTableBodyNone">8 GiB   </td><td class="markdownTableBodyNone">4 GiB   </td><td class="markdownTableBodyNone">2 GiB   </td><td class="markdownTableBodyNone">1 GiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">16 TiB   </td><td class="markdownTableBodyNone">8 TiB   </td><td class="markdownTableBodyNone">4 TiB   </td><td class="markdownTableBodyNone">2 TiB   </td><td class="markdownTableBodyNone">1 TiB   </td></tr>
</table>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a> to create a state-vector of the equivalent number of qubits, with a square-root memory cost</li>
<li><a class="el" href="group__type.html#gabd07eee133dcd4e6ae7c2d2ce4c42978" title="Create a new Qureg which is an exact clone of the passed qureg, which can be either a state-vector or...">createCloneQureg()</a> to create a new qureg of the size and state of an existing qureg.</li>
<li><a class="el" href="group__type.html#ga8e1e6ad3254892edc2ee08712ea9d692" title="Deallocate a Qureg, freeing its memory.">destroyQureg()</a> to free the allocated <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code> memory.</li>
<li><a class="el" href="group__debug.html#ga97d96af7c7ea7b31e32cbe3b25377e09" title="Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.">reportQuregParams()</a> to print information about a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>.</li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>an object representing the set of qubits </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>numQubits</code> &lt;= 0</li>
<li>if <code>numQubits</code> is so large that the number of amplitudes cannot fit in a long long int type,</li>
<li>if in distributed mode, there are more nodes than elements in the would-be state-vector </li>
</ul>
</td></tr>
    <tr><td class="paramname">exit</td><td><ul>
<li>if in GPU mode, but GPU memory cannot be allocated. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00050">50</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>                                                      {</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a45428d4a49b8798a8d25a7155f622238">validateNumQubitsInQureg</a>(2*numQubits, env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, __func__);</div>
<div class="line"><span class="lineno">   52</span>    </div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_struct" href="structQureg.html">Qureg</a> qureg;</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a>(&amp;qureg, 2*numQubits, env);</div>
<div class="line"><span class="lineno">   55</span>    qureg.<a class="code hl_variable" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a> = 1;</div>
<div class="line"><span class="lineno">   56</span>    qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a> = numQubits;</div>
<div class="line"><span class="lineno">   57</span>    qureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = 2*numQubits;</div>
<div class="line"><span class="lineno">   58</span>    </div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_function" href="QuEST__qasm_8c.html#aa5f05644a6cea13e00f828658bcf7a68">qasm_setup</a>(&amp;qureg);</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_function" href="group__init.html#ga2f049055d4a51d0ea4d1a43b5234dedb">initZeroState</a>(qureg); <span class="comment">// safe call to public function</span></div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">return</span> qureg;</div>
<div class="line"><span class="lineno">   62</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_a45428d4a49b8798a8d25a7155f622238"><div class="ttname"><a href="QuEST__validation_8c.html#a45428d4a49b8798a8d25a7155f622238">validateNumQubitsInQureg</a></div><div class="ttdeci">void validateNumQubitsInQureg(int numQubits, int numRanks, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00371">QuEST_validation.c:371</a></div></div>
<div class="ttc" id="agroup__init_html_ga2f049055d4a51d0ea4d1a43b5234dedb"><div class="ttname"><a href="group__init.html#ga2f049055d4a51d0ea4d1a43b5234dedb">initZeroState</a></div><div class="ttdeci">void initZeroState(Qureg qureg)</div><div class="ttdoc">Initialise qureg into the zero state.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00113">QuEST.c:113</a></div></div>
<div class="ttc" id="astructQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00386">QuEST.h:386</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8c_source.html#l00113">initZeroState()</a>, <a class="el" href="QuEST_8h_source.html#l00346">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00350">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00386">QuESTEnv::numRanks</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00056">qasm_setup()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01296">statevec_createQureg()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00371">validateNumQubitsInQureg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__calculations_8cpp_source.html#l00015">TEST_CASE()</a>.</p>

</div>
</div>
<a id="gaebf896dd8d5eeaf9fd896f6cc8e334fe" name="gaebf896dd8d5eeaf9fd896f6cc8e334fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaebf896dd8d5eeaf9fd896f6cc8e334fe">&#9670;&#160;</a></span>createDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDiagonalOp.html">DiagonalOp</a> createDiagonalOp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> representing a diagonal operator on the full Hilbert space of a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>. </p>
<p >The resulting operator need not be unitary nor Hermitian, and can be applied to any <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> of a compatible number of qubits.</p>
<p >This function allocates space for \(2^{\text{numQubits}}\) complex amplitudes, which are initially zero. This is the same cost as a local state-vector of equal number of qubits; see the Serial section of <a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a>. Note that this is a <em>paralell</em> data-type, so its ultimate memory costs depend on the hardware backends, as elaborated below.</p>
<p >The operator elements should be modified with <a class="el" href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46" title="Overwrites the entire DiagonalOp op with the given real and imag complex elements.">initDiagonalOp()</a> and <a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a>, and must be later freed with <a class="el" href="group__type.html#ga2c59f45fab56708f687b4104ee99bcd1" title="Destroys a DiagonalOp created with createDiagonalOp(), freeing its memory.">destroyDiagonalOp()</a>.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
GPU</h3>
<p >In GPU-accelerated mode, this function also creates additional equally-sized persistent memory on the GPU. If you wish to modify the operator elements directly (in lieu of <a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a>), you must thereafter call <a class="el" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9" title="Update the GPU memory with the current values in op.real and op.imag.">syncDiagonalOp()</a> to update the operator stored in VRAM.</p>
<p >For example, </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structDiagonalOp.html">DiagonalOp</a> op = <a class="code hl_function" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">createDiagonalOp</a>(4, env);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>; i++) {</div>
<div class="line">    op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>[i] = rand();</div>
<div class="line">    op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>[i] = rand();</div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9">syncDiagonalOp</a>(op);</div>
<div class="ttc" id="agroup__type_html_gab75d5cdc622d2778bad24e3a8130aab9"><div class="ttname"><a href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9">syncDiagonalOp</a></div><div class="ttdeci">void syncDiagonalOp(DiagonalOp op)</div><div class="ttdoc">Update the GPU memory with the current values in op.real and op.imag.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01657">QuEST.c:1657</a></div></div>
<div class="ttc" id="agroup__type_html_gaebf896dd8d5eeaf9fd896f6cc8e334fe"><div class="ttname"><a href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">createDiagonalOp</a></div><div class="ttdeci">DiagonalOp createDiagonalOp(int numQubits, QuESTEnv env)</div><div class="ttdoc">Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01644">QuEST.c:1644</a></div></div>
<div class="ttc" id="astructDiagonalOp_html"><div class="ttname"><a href="structDiagonalOp.html">DiagonalOp</a></div><div class="ttdoc">Represents a diagonal complex operator on the full Hilbert state of a Qureg.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00299">QuEST.h:300</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a1d66088bed235d524cd452b107694d5c"><div class="ttname"><a href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">DiagonalOp::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdoc">The real values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00310">QuEST.h:310</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a2c6eab631ef48b4978db026c98180eee"><div class="ttname"><a href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">DiagonalOp::numElemsPerChunk</a></div><div class="ttdeci">long long int numElemsPerChunk</div><div class="ttdoc">The number of the 2^numQubits amplitudes stored on each distributed node.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00304">QuEST.h:304</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a85c3f52533efe831bbe40b9a48602388"><div class="ttname"><a href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">DiagonalOp::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdoc">The imaginary values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00312">QuEST.h:312</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md19"></a>
Distribution</h3>
<p >In distributed mode, the memory for the diagonal operator is divided evenly between the \(N\) available nodes, such that each node contains only \(2^{\text{numQubits}}/N\) complex values. This is assigned to <a class="el" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee" title="The number of the 2^numQubits amplitudes stored on each distributed node.">DiagonalOp.numElemsPerChunk</a>.</p>
<p >Users must therefore exercise care in modifying <a class="el" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c" title="The real values of the 2^numQubits complex elements.">DiagonalOp.real</a> and <a class="el" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388" title="The imaginary values of the 2^numQubits complex elements.">DiagonalOp.imag</a> directly.</p>
<p >For example, the following is valid code when when distributed between <b>N = 2</b> nodes: </p><div class="fragment"><div class="line"><span class="comment">// create diag({1,2,3,4,5,6,7,8, 9,10,11,12,13,14,15,16})</span></div>
<div class="line"><span class="keywordtype">int</span> numQubits = 4;</div>
<div class="line"><a class="code hl_struct" href="structDiagonalOp.html">DiagonalOp</a> op = <a class="code hl_function" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">createDiagonalOp</a>(numQubits, env);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (env.rank == 0)</div>
<div class="line">        op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>[i] = (i+1);</div>
<div class="line">    <span class="keywordflow">if</span> (env.rank == 1)</div>
<div class="line">        op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>[i] = (i+1+8);</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br  />
</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#gaa86572b44755646858d6b0292d53cc15" title="Creates and initialiases a diagonal operator from the Z Pauli Hamiltonian encoded in file with filena...">createDiagonalOpFromPauliHamilFile()</a></li>
<li><a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a></li>
<li><a class="el" href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46" title="Overwrites the entire DiagonalOp op with the given real and imag complex elements.">initDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9" title="Update the GPU memory with the current values in op.real and op.imag.">syncDiagonalOp()</a></li>
<li><a class="el" href="group__operator.html#gad2e953390342cd361cfb4064d47715e6" title="Apply a diagonal operator, which is possibly non-unitary and non-Hermitian, to the entire qureg.">applyDiagonalOp()</a></li>
<li><a class="el" href="group__calc.html#ga82f17e96a4cb7612fb9c6ef856df3810" title="Computes the expected value of the diagonal operator op for state qureg.">calcExpecDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#ga2c59f45fab56708f687b4104ee99bcd1" title="Destroys a DiagonalOp created with createDiagonalOp(), freeing its memory.">destroyDiagonalOp()</a></li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>a dynamic <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> instance initialised to diag(0,0,...). </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits which inform the Hilbert dimension of the operator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>the <a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>numQubits</code> &lt;= 0</li>
<li>if <code>numQubits</code> is so large that the number of elements cannot fit in a long long int type,</li>
<li>if in distributed mode, there are more nodes than elements in the operator </li>
</ul>
</td></tr>
    <tr><td class="paramname">exit</td><td><ul>
<li>if the memory could not be allocated </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01644">1644</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1644</span>                                                         {</div>
<div class="line"><span class="lineno"> 1645</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a7891142f169db6d440a4145501cd1d4c">validateNumQubitsInDiagOp</a>(numQubits, env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, __func__);</div>
<div class="line"><span class="lineno"> 1646</span>    </div>
<div class="line"><span class="lineno"> 1647</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="QuEST__internal_8h.html#a0b84e6766bd682708e6211276ff0a5bb">agnostic_createDiagonalOp</a>(numQubits, env);</div>
<div class="line"><span class="lineno"> 1648</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_a0b84e6766bd682708e6211276ff0a5bb"><div class="ttname"><a href="QuEST__internal_8h.html#a0b84e6766bd682708e6211276ff0a5bb">agnostic_createDiagonalOp</a></div><div class="ttdeci">DiagonalOp agnostic_createDiagonalOp(int numQubits, QuESTEnv env)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01388">QuEST_cpu.c:1388</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_a7891142f169db6d440a4145501cd1d4c"><div class="ttname"><a href="QuEST__validation_8c.html#a7891142f169db6d440a4145501cd1d4c">validateNumQubitsInDiagOp</a></div><div class="ttdeci">void validateNumQubitsInDiagOp(int numQubits, int numRanks, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00387">QuEST_validation.c:387</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l01388">agnostic_createDiagonalOp()</a>, <a class="el" href="QuEST_8h_source.html#l00386">QuESTEnv::numRanks</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00387">validateNumQubitsInDiagOp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__calculations_8cpp_source.html#l00111">TEST_CASE()</a>.</p>

</div>
</div>
<a id="gaa86572b44755646858d6b0292d53cc15" name="gaa86572b44755646858d6b0292d53cc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa86572b44755646858d6b0292d53cc15">&#9670;&#160;</a></span>createDiagonalOpFromPauliHamilFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDiagonalOp.html">DiagonalOp</a> createDiagonalOpFromPauliHamilFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and initialiases a diagonal operator from the Z Pauli Hamiltonian encoded in file with filename <code>fn</code>. </p>
<p >This is a convenience function to prepare a diagonal operator from a plaintext description of an all-Z Pauli Hamiltonian. The returned <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> is a distributed data structure, and significantly faster to use (through functions like <a class="el" href="group__calc.html#ga82f17e96a4cb7612fb9c6ef856df3810" title="Computes the expected value of the diagonal operator op for state qureg.">calcExpecDiagonalOp()</a>) than <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> functions (like <a class="el" href="group__calc.html#ga5544d2833a69941b8820797b79daf79f" title="Computes the expected value of qureg under Hermitian operator hamil.">calcExpecPauliHamil()</a>).</p>
<ul>
<li>See <a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a> for info about the returned operator.</li>
<li>See <a class="el" href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad" title="Populates the diagonal operator op to be equivalent to the given Pauli Hamiltonian hamil,...">initDiagonalOpFromPauliHamil()</a> for info about the initialised state.</li>
<li>See <a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a> for info about the required file format.</li>
</ul>
<blockquote class="doxtable">
<p >&zwj;The returned <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> must be later freed with <a class="el" href="group__type.html#ga2c59f45fab56708f687b4104ee99bcd1" title="Destroys a DiagonalOp created with createDiagonalOp(), freeing its memory.">destroyDiagonalOp()</a>. <br  />
 Note a <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> from <code>fn</code> is temporarily internally created. </p>
</blockquote>
<p>This function is equivalent to </p><div class="fragment"><div class="line"><span class="comment">// produce diagonal matrix d</span></div>
<div class="line"><a class="code hl_struct" href="structPauliHamil.html">PauliHamil</a> h = <a class="code hl_function" href="group__type.html#gaa77376c5e3518186eb085f37826d6008">createPauliHamilFromFile</a>(fn);</div>
<div class="line"><a class="code hl_struct" href="structDiagonalOp.html">DiagonalOp</a> d = <a class="code hl_function" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">createDiagonalOp</a>(h.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>, env);</div>
<div class="line"><a class="code hl_function" href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad">initDiagonalOpFromPauliHamil</a>(d, h); </div>
<div class="line"><a class="code hl_function" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6">destroyPauliHamil</a>(h);</div>
<div class="ttc" id="agroup__type_html_ga2ecd67e0de9efcbbe37afbad28a8ffad"><div class="ttname"><a href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad">initDiagonalOpFromPauliHamil</a></div><div class="ttdeci">void initDiagonalOpFromPauliHamil(DiagonalOp op, PauliHamil hamil)</div><div class="ttdoc">Populates the diagonal operator op to be equivalent to the given Pauli Hamiltonian hamil,...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01676">QuEST.c:1676</a></div></div>
<div class="ttc" id="agroup__type_html_gaa77376c5e3518186eb085f37826d6008"><div class="ttname"><a href="group__type.html#gaa77376c5e3518186eb085f37826d6008">createPauliHamilFromFile</a></div><div class="ttdeci">PauliHamil createPauliHamilFromFile(char *fn)</div><div class="ttdoc">Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01546">QuEST.c:1546</a></div></div>
<div class="ttc" id="agroup__type_html_gac1c8ed909b33bd55ae680901006051b6"><div class="ttname"><a href="group__type.html#gac1c8ed909b33bd55ae680901006051b6">destroyPauliHamil</a></div><div class="ttdeci">void destroyPauliHamil(PauliHamil h)</div><div class="ttdoc">Destroy a PauliHamil instance, created with either createPauliHamil() or createPauliHamilFromFile().</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01540">QuEST.c:1540</a></div></div>
<div class="ttc" id="astructPauliHamil_html"><div class="ttname"><a href="structPauliHamil.html">PauliHamil</a></div><div class="ttdoc">A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00279">QuEST.h:280</a></div></div>
<div class="ttc" id="astructPauliHamil_html_acb49fff0e3160ea1904c9ca34408b4e1"><div class="ttname"><a href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">PauliHamil::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">The number of qubits informing the Hilbert dimension of the Hamiltonian.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00289">QuEST.h:289</a></div></div>
</div><!-- fragment --><p> <br  />
</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad" title="Populates the diagonal operator op to be equivalent to the given Pauli Hamiltonian hamil,...">initDiagonalOpFromPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a></li>
<li><a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#ga2c59f45fab56708f687b4104ee99bcd1" title="Destroys a DiagonalOp created with createDiagonalOp(), freeing its memory.">destroyDiagonalOp()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fn</td><td>filename of a plaintext file encoding an all-Z Pauli Hamiltonian </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>the session <a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a created <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> equivalent to the Hamiltonian in <code>fn</code> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if file <code>fn</code> cannot be read</li>
<li>if file <code>fn</code> does not encode a valid <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></li>
<li>if the encoded <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> consists of operators other than <code>PAULI_Z</code> and <code>PAULI_I</code> </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd>
<dd>
Milos Prokop (serial prototype) </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01684">1684</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1684</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1685</span>    <a class="code hl_struct" href="structPauliHamil.html">PauliHamil</a> h = <a class="code hl_function" href="group__type.html#gaa77376c5e3518186eb085f37826d6008">createPauliHamilFromFile</a>(fn); <span class="comment">// validates fn</span></div>
<div class="line"><span class="lineno"> 1686</span>    <a class="code hl_function" href="QuEST__validation_8c.html#aab3d6c019d9bbdf3d647c944e8b9e363">validateDiagPauliHamilFromFile</a>(h, env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, __func__);  <span class="comment">// destroys h if invalid</span></div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>    <a class="code hl_struct" href="structDiagonalOp.html">DiagonalOp</a> op = <a class="code hl_function" href="QuEST__internal_8h.html#a0b84e6766bd682708e6211276ff0a5bb">agnostic_createDiagonalOp</a>(h.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>, env);</div>
<div class="line"><span class="lineno"> 1689</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a81a87bb0f0805c9dfcb691f6cb15a1b5">agnostic_initDiagonalOpFromPauliHamil</a>(op, h);</div>
<div class="line"><span class="lineno"> 1690</span>    </div>
<div class="line"><span class="lineno"> 1691</span>    <a class="code hl_function" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6">destroyPauliHamil</a>(h);</div>
<div class="line"><span class="lineno"> 1692</span>    <span class="keywordflow">return</span> op;</div>
<div class="line"><span class="lineno"> 1693</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_a81a87bb0f0805c9dfcb691f6cb15a1b5"><div class="ttname"><a href="QuEST__internal_8h.html#a81a87bb0f0805c9dfcb691f6cb15a1b5">agnostic_initDiagonalOpFromPauliHamil</a></div><div class="ttdeci">void agnostic_initDiagonalOpFromPauliHamil(DiagonalOp op, PauliHamil hamil)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01416">QuEST_cpu.c:1416</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_aab3d6c019d9bbdf3d647c944e8b9e363"><div class="ttname"><a href="QuEST__validation_8c.html#aab3d6c019d9bbdf3d647c944e8b9e363">validateDiagPauliHamilFromFile</a></div><div class="ttdeci">void validateDiagPauliHamilFromFile(PauliHamil hamil, int numRanks, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00785">QuEST_validation.c:785</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l01388">agnostic_createDiagonalOp()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01416">agnostic_initDiagonalOpFromPauliHamil()</a>, <a class="el" href="QuEST_8c_source.html#l01546">createPauliHamilFromFile()</a>, <a class="el" href="QuEST_8c_source.html#l01540">destroyPauliHamil()</a>, <a class="el" href="QuEST_8h_source.html#l00289">PauliHamil::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00386">QuESTEnv::numRanks</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00785">validateDiagPauliHamilFromFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00270">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga35b28710877c462927366fa602e591cb" name="ga35b28710877c462927366fa602e591cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35b28710877c462927366fa602e591cb">&#9670;&#160;</a></span>createPauliHamil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structPauliHamil.html">PauliHamil</a> createPauliHamil </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numSumTerms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators. </p>
<p >A <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> is merely an encapsulation of the multiple parameters of functions like <a class="el" href="group__operator.html#ga6fc26cf857db070e12959e59ecfed8a6" title="Modifies outQureg to be the result of applying the weighted sum of Pauli products (a Hermitian but no...">applyPauliSum()</a>.</p>
<p >The Pauli operators (<a class="el" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8" title="The Pauli operators acting on each qubit, flattened over every operator.">PauliHamil.pauliCodes</a>) are all initialised to identity (<a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a>), but the coefficients (<a class="el" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac" title="The real coefficient of each Pauli product. This is an array of length PauliHamil....">PauliHamil.termCoeffs</a>) are not initialised.</p>
<p >The Hamiltonian can be used in functions like <a class="el" href="group__operator.html#ga54d4e589468002bdc998200ae45e7312" title="Modifies outQureg to be the result of applying PauliHamil (a Hermitian but not necessarily unitary op...">applyPauliHamil()</a> and <a class="el" href="group__operator.html#ga35b6321c578a8c69470132b5ee95f930" title="Applies a trotterisation of unitary evolution  to qureg.">applyTrotterCircuit()</a>, with <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code> instances of the same number of qubits.</p>
<p >A <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> can be modified directly (see <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a>), or through <a class="el" href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a" title="Initialise PauliHamil instance hamil with the given term coefficients and Pauli codes (one for every ...">initPauliHamil()</a>. It can furthermore be created and initialised from a file description directly with <a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a>.</p>
<blockquote class="doxtable">
<p >&zwj;The returned dynamic <code><a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></code> instance must later be freed via <a class="el" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6" title="Destroy a PauliHamil instance, created with either createPauliHamil() or createPauliHamilFromFile().">destroyPauliHamil()</a>. </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a></li>
<li><a class="el" href="group__type.html#gaa86572b44755646858d6b0292d53cc15" title="Creates and initialiases a diagonal operator from the Z Pauli Hamiltonian encoded in file with filena...">createDiagonalOpFromPauliHamilFile()</a></li>
<li><a class="el" href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a" title="Initialise PauliHamil instance hamil with the given term coefficients and Pauli codes (one for every ...">initPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6" title="Destroy a PauliHamil instance, created with either createPauliHamil() or createPauliHamilFromFile().">destroyPauliHamil()</a></li>
<li><a class="el" href="group__operator.html#ga6fc26cf857db070e12959e59ecfed8a6" title="Modifies outQureg to be the result of applying the weighted sum of Pauli products (a Hermitian but no...">applyPauliSum()</a></li>
<li><a class="el" href="group__operator.html#ga35b6321c578a8c69470132b5ee95f930" title="Applies a trotterisation of unitary evolution  to qureg.">applyTrotterCircuit()</a></li>
<li><a class="el" href="group__calc.html#ga5544d2833a69941b8820797b79daf79f" title="Computes the expected value of qureg under Hermitian operator hamil.">calcExpecPauliHamil()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>the number of qubits on which this Hamiltonian acts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numSumTerms</td><td>the number of weighted terms in the sum, or the number of Pauli products </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a dynamic <code><a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></code> struct, with fields <code>pauliCodes</code> and <code>termCoeffs</code> stored in the heap </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>numQubits</code> &lt;= 0</li>
<li>if <code>numSumTerms</code> &lt;= 0 </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01524">1524</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1524</span>                                                            {</div>
<div class="line"><span class="lineno"> 1525</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a7de9c41e77487a2939ed076f0cf674e7">validateHamilParams</a>(numQubits, numSumTerms, __func__);</div>
<div class="line"><span class="lineno"> 1526</span>    </div>
<div class="line"><span class="lineno"> 1527</span>    <a class="code hl_struct" href="structPauliHamil.html">PauliHamil</a> h;</div>
<div class="line"><span class="lineno"> 1528</span>    h.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a> = numQubits;</div>
<div class="line"><span class="lineno"> 1529</span>    h.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a> = numSumTerms;</div>
<div class="line"><span class="lineno"> 1530</span>    h.<a class="code hl_variable" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">termCoeffs</a> = malloc(numSumTerms * <span class="keyword">sizeof</span> *h.<a class="code hl_variable" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">termCoeffs</a>);</div>
<div class="line"><span class="lineno"> 1531</span>    h.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a> = malloc(numQubits*numSumTerms * <span class="keyword">sizeof</span> *h.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>);</div>
<div class="line"><span class="lineno"> 1532</span>    </div>
<div class="line"><span class="lineno"> 1533</span>    <span class="comment">// initialise pauli codes to identity </span></div>
<div class="line"><span class="lineno"> 1534</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numQubits*numSumTerms; i++)</div>
<div class="line"><span class="lineno"> 1535</span>        h.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>[i] = <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a>;</div>
<div class="line"><span class="lineno"> 1536</span>    </div>
<div class="line"><span class="lineno"> 1537</span>    <span class="keywordflow">return</span> h;</div>
<div class="line"><span class="lineno"> 1538</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_a7de9c41e77487a2939ed076f0cf674e7"><div class="ttname"><a href="QuEST__validation_8c.html#a7de9c41e77487a2939ed076f0cf674e7">validateHamilParams</a></div><div class="ttdeci">void validateHamilParams(int numQubits, int numTerms, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00709">QuEST_validation.c:709</a></div></div>
<div class="ttc" id="astructPauliHamil_html_a4b8d38c403553c07ceddcd40c46ce6c8"><div class="ttname"><a href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">PauliHamil::pauliCodes</a></div><div class="ttdeci">enum pauliOpType * pauliCodes</div><div class="ttdoc">The Pauli operators acting on each qubit, flattened over every operator.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00283">QuEST.h:283</a></div></div>
<div class="ttc" id="astructPauliHamil_html_a737e46b40ef8990cf004d22eb9dbe2e4"><div class="ttname"><a href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">PauliHamil::numSumTerms</a></div><div class="ttdeci">int numSumTerms</div><div class="ttdoc">The number of terms in the weighted sum, or the number of Pauli products.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00287">QuEST.h:287</a></div></div>
<div class="ttc" id="astructPauliHamil_html_ac1c6c9f6299cf83bbba88123216c3cac"><div class="ttname"><a href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">PauliHamil::termCoeffs</a></div><div class="ttdeci">qreal * termCoeffs</div><div class="ttdoc">The real coefficient of each Pauli product. This is an array of length PauliHamil....</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00285">QuEST.h:285</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00289">PauliHamil::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00287">PauliHamil::numSumTerms</a>, <a class="el" href="QuEST_8h_source.html#l00096">PAULI_I</a>, <a class="el" href="QuEST_8h_source.html#l00283">PauliHamil::pauliCodes</a>, <a class="el" href="QuEST_8h_source.html#l00285">PauliHamil::termCoeffs</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00709">validateHamilParams()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l01546">createPauliHamilFromFile()</a>, and <a class="el" href="test__calculations_8cpp_source.html#l00183">TEST_CASE()</a>.</p>

</div>
</div>
<a id="gaa77376c5e3518186eb085f37826d6008" name="gaa77376c5e3518186eb085f37826d6008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa77376c5e3518186eb085f37826d6008">&#9670;&#160;</a></span>createPauliHamilFromFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structPauliHamil.html">PauliHamil</a> createPauliHamilFromFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a <code><a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></code> instance, a real-weighted sum of products of Pauli operators, populated with the data in filename <code>fn</code>. </p>
<p >Each line in the plaintext file is interpreted as a separate product of Pauli operators in the total sum. Each line must be a space-separated list with format </p><pre class="fragment">c p1 p2 p3 ... pN
</pre><p> where <code>c</code> is the real coefficient of the term, and <code>p1</code> ... <code>pN</code> are numbers in <b>{0,1,2,3}</b> to indicate <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a>, <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c">PAULI_X</a>, <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd">PAULI_Y</a>, <a class="el" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a> operators respectively, which act on qubits <code>0</code> through <code>N-1</code> (all qubits).</p>
<p >For example, the file containing </p><pre class="fragment">0.31 1 0 1 2
-0.2 3 2 0 0
</pre><p> encodes a two-term four-qubit Hamiltonian  </p><p class="formulaDsp">
\[ 
     0.31 \, X_0 \, X_2 \, Y_3 -0.2 \, Z_0 \, Y_1 \,.
\]
</p>
<p >The initialised <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> can be previewed with <a class="el" href="group__debug.html#gab27234d9ccf440bb5e5d834e8f7e3938" title="Print the PauliHamil to screen.">reportPauliHamil()</a>.</p>
<p >The number of qubits and terms are inferred from the file. The created Hamiltonian can be used just like one created via <a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a>. It can be modified directly (see <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a>), or through <a class="el" href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a" title="Initialise PauliHamil instance hamil with the given term coefficients and Pauli codes (one for every ...">initPauliHamil()</a>.</p>
<blockquote class="doxtable">
<p >&zwj;The returned dynamic <code><a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></code> instance must later be freed via <a class="el" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6" title="Destroy a PauliHamil instance, created with either createPauliHamil() or createPauliHamilFromFile().">destroyPauliHamil()</a>. </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__debug.html#gab27234d9ccf440bb5e5d834e8f7e3938" title="Print the PauliHamil to screen.">reportPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gac1c8ed909b33bd55ae680901006051b6" title="Destroy a PauliHamil instance, created with either createPauliHamil() or createPauliHamilFromFile().">destroyPauliHamil()</a></li>
<li><a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a" title="Initialise PauliHamil instance hamil with the given term coefficients and Pauli codes (one for every ...">initPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gaa86572b44755646858d6b0292d53cc15" title="Creates and initialiases a diagonal operator from the Z Pauli Hamiltonian encoded in file with filena...">createDiagonalOpFromPauliHamilFile()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fn</td><td>filename of the plaintext file specifying the pauli operators and coefficients </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a dynamic <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> struct </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if the file with name <code>fn</code> cannot be read</li>
<li>if the file is not correctly formatted as described above </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01546">1546</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1546</span>                                              {</div>
<div class="line"><span class="lineno"> 1547</span>    </div>
<div class="line"><span class="lineno"> 1548</span>    <span class="comment">/* The validation in this function must close the file handle and free </span></div>
<div class="line"><span class="lineno"> 1549</span><span class="comment">     * allocated memory before raising an error (whether that&#39;s a C exit, or</span></div>
<div class="line"><span class="lineno"> 1550</span><span class="comment">     * an overriden C++ exception).</span></div>
<div class="line"><span class="lineno"> 1551</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1552</span>    </div>
<div class="line"><span class="lineno"> 1553</span>        FILE* <a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a> = fopen(fn, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 1554</span>    <span class="keywordtype">int</span> success = (<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a> != NULL);</div>
<div class="line"><span class="lineno"> 1555</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a6b9523909701f7bd79f2ab7b56a8e6bd">validateFileOpened</a>(success, fn, __func__);</div>
<div class="line"><span class="lineno"> 1556</span>    </div>
<div class="line"><span class="lineno"> 1557</span>    <span class="comment">/* file format: coeff {term} \n where {term} is #numQubits values of </span></div>
<div class="line"><span class="lineno"> 1558</span><span class="comment">         * 0 1 2 3 signifying I X Y Z acting on that qubit index</span></div>
<div class="line"><span class="lineno"> 1559</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1560</span>        </div>
<div class="line"><span class="lineno"> 1561</span>        <span class="comment">// count the number of qubits (ignore trailing whitespace)</span></div>
<div class="line"><span class="lineno"> 1562</span>        <span class="keywordtype">int</span> numQubits = -1; <span class="comment">// to exclude coeff at start</span></div>
<div class="line"><span class="lineno"> 1563</span>        <span class="keywordtype">char</span> ch = getc(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>);</div>
<div class="line"><span class="lineno"> 1564</span>    <span class="keywordtype">char</span> prev = <span class="charliteral">&#39;0&#39;</span>; <span class="comment">// anything not space</span></div>
<div class="line"><span class="lineno"> 1565</span>        <span class="keywordflow">while</span> (ch != <span class="charliteral">&#39;\n&#39;</span> &amp;&amp; ch != EOF) {</div>
<div class="line"><span class="lineno"> 1566</span>                <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39; &#39;</span> &amp;&amp; prev != <span class="charliteral">&#39; &#39;</span>) <span class="comment">// skip multiple spaces</span></div>
<div class="line"><span class="lineno"> 1567</span>                        numQubits++;</div>
<div class="line"><span class="lineno"> 1568</span>        prev = ch;</div>
<div class="line"><span class="lineno"> 1569</span>        ch = getc(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>);</div>
<div class="line"><span class="lineno"> 1570</span>    }</div>
<div class="line"><span class="lineno"> 1571</span>    <span class="comment">// edge-case: if we hit EOF/newline without a space</span></div>
<div class="line"><span class="lineno"> 1572</span>    <span class="keywordflow">if</span> (prev != <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><span class="lineno"> 1573</span>        numQubits++;</div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span>    <span class="comment">/* TODO:</span></div>
<div class="line"><span class="lineno"> 1576</span><span class="comment">     * The below code may break on Windows where newlines are multiple characters</span></div>
<div class="line"><span class="lineno"> 1577</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1578</span>        </div>
<div class="line"><span class="lineno"> 1579</span>        <span class="comment">// count the number of terms (being cautious of trailing newlines)</span></div>
<div class="line"><span class="lineno"> 1580</span>    <span class="keywordtype">int</span> numTerms = 0;</div>
<div class="line"><span class="lineno"> 1581</span>    prev = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><span class="lineno"> 1582</span>    rewind(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>);</div>
<div class="line"><span class="lineno"> 1583</span>        <span class="keywordflow">while</span> ((ch=getc(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>)) != EOF) {</div>
<div class="line"><span class="lineno"> 1584</span>                <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;\n&#39;</span> &amp;&amp; prev != <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno"> 1585</span>                        numTerms++;</div>
<div class="line"><span class="lineno"> 1586</span>        prev = ch;</div>
<div class="line"><span class="lineno"> 1587</span>    }</div>
<div class="line"><span class="lineno"> 1588</span>    <span class="comment">// edge-case: if we hit EOF without a newline, count that line</span></div>
<div class="line"><span class="lineno"> 1589</span>    <span class="keywordflow">if</span> (prev != <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno"> 1590</span>        numTerms++;</div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span>    <span class="comment">// validate the inferred number of terms and qubits (closes file if error)</span></div>
<div class="line"><span class="lineno"> 1593</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a73bb5e6a5dcfba274ce93355d4a04db4">validateHamilFileParams</a>(numQubits, numTerms, <a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>, fn, __func__);</div>
<div class="line"><span class="lineno"> 1594</span>    </div>
<div class="line"><span class="lineno"> 1595</span>    <span class="comment">// allocate space for PauliHamil data</span></div>
<div class="line"><span class="lineno"> 1596</span>    <a class="code hl_struct" href="structPauliHamil.html">PauliHamil</a> h = <a class="code hl_function" href="group__type.html#ga35b28710877c462927366fa602e591cb">createPauliHamil</a>(numQubits, numTerms);</div>
<div class="line"><span class="lineno"> 1597</span>     </div>
<div class="line"><span class="lineno"> 1598</span>    <span class="comment">// specifier for a qreal number then a space </span></div>
<div class="line"><span class="lineno"> 1599</span>    <span class="keywordtype">char</span> strSpec[50];</div>
<div class="line"><span class="lineno"> 1600</span>    strcpy(strSpec, REAL_SPECIFIER);</div>
<div class="line"><span class="lineno"> 1601</span>    strcat(strSpec, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno"> 1602</span>    </div>
<div class="line"><span class="lineno"> 1603</span>    <span class="comment">// collect coefficients and terms</span></div>
<div class="line"><span class="lineno"> 1604</span>        rewind(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>);</div>
<div class="line"><span class="lineno"> 1605</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=0; t&lt;numTerms; t++) {</div>
<div class="line"><span class="lineno"> 1606</span>                </div>
<div class="line"><span class="lineno"> 1607</span>                <span class="comment">// record coefficient, and validate (closes file and frees h if error)</span></div>
<div class="line"><span class="lineno"> 1608</span>        success = fscanf(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>, strSpec, &amp;(h.<a class="code hl_variable" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">termCoeffs</a>[t])) == 1;</div>
<div class="line"><span class="lineno"> 1609</span>        <a class="code hl_function" href="QuEST__validation_8c.html#a03b219da14463416c174c08b027deb31">validateHamilFileCoeffParsed</a>(success, h, <a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>, fn, __func__);</div>
<div class="line"><span class="lineno"> 1610</span> </div>
<div class="line"><span class="lineno"> 1611</span>                <span class="comment">// record Pauli operations, and validate (closes file and frees h if error)</span></div>
<div class="line"><span class="lineno"> 1612</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> q=0; q&lt;numQubits; q++) {</div>
<div class="line"><span class="lineno"> 1613</span>            <span class="keywordtype">int</span> i = t*numQubits + q;</div>
<div class="line"><span class="lineno"> 1614</span>            </div>
<div class="line"><span class="lineno"> 1615</span>            <span class="comment">// verbose, to avoid type warnings</span></div>
<div class="line"><span class="lineno"> 1616</span>            <span class="keywordtype">int</span> code;</div>
<div class="line"><span class="lineno"> 1617</span>            success = fscanf(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>, <span class="stringliteral">&quot;%d &quot;</span>, &amp;code) == 1;</div>
<div class="line"><span class="lineno"> 1618</span>            h.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>[i] = (<span class="keyword">enum</span> <a class="code hl_enumeration" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a>) code;</div>
<div class="line"><span class="lineno"> 1619</span>            <a class="code hl_function" href="QuEST__validation_8c.html#aab522b9871ea39eaf76d36850817e5bc">validateHamilFilePauliParsed</a>(success, h, <a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>, fn, __func__);</div>
<div class="line"><span class="lineno"> 1620</span>            <a class="code hl_function" href="QuEST__validation_8c.html#a23a0025b20f876844320f40fc02cdb69">validateHamilFilePauliCode</a>(h.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>[i], h, <a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>, fn, __func__);</div>
<div class="line"><span class="lineno"> 1621</span>                }</div>
<div class="line"><span class="lineno"> 1622</span> </div>
<div class="line"><span class="lineno"> 1623</span>                <span class="comment">// the trailing newline is magically eaten</span></div>
<div class="line"><span class="lineno"> 1624</span>        }</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>    fclose(<a class="code hl_variable" href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a>);</div>
<div class="line"><span class="lineno"> 1627</span>        <span class="keywordflow">return</span> h;</div>
<div class="line"><span class="lineno"> 1628</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_a03b219da14463416c174c08b027deb31"><div class="ttname"><a href="QuEST__validation_8c.html#a03b219da14463416c174c08b027deb31">validateHamilFileCoeffParsed</a></div><div class="ttdeci">void validateHamilFileCoeffParsed(int parsed, PauliHamil h, FILE *file, char *fn, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00731">QuEST_validation.c:731</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_a23a0025b20f876844320f40fc02cdb69"><div class="ttname"><a href="QuEST__validation_8c.html#a23a0025b20f876844320f40fc02cdb69">validateHamilFilePauliCode</a></div><div class="ttdeci">void validateHamilFilePauliCode(enum pauliOpType code, PauliHamil h, FILE *file, char *fn, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00751">QuEST_validation.c:751</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_a6b9523909701f7bd79f2ab7b56a8e6bd"><div class="ttname"><a href="QuEST__validation_8c.html#a6b9523909701f7bd79f2ab7b56a8e6bd">validateFileOpened</a></div><div class="ttdeci">void validateFileOpened(int opened, char *fn, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00595">QuEST_validation.c:595</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_a73bb5e6a5dcfba274ce93355d4a04db4"><div class="ttname"><a href="QuEST__validation_8c.html#a73bb5e6a5dcfba274ce93355d4a04db4">validateHamilFileParams</a></div><div class="ttdeci">void validateHamilFileParams(int numQubits, int numTerms, FILE *file, char *fn, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00722">QuEST_validation.c:722</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_aab522b9871ea39eaf76d36850817e5bc"><div class="ttname"><a href="QuEST__validation_8c.html#aab522b9871ea39eaf76d36850817e5bc">validateHamilFilePauliParsed</a></div><div class="ttdeci">void validateHamilFilePauliParsed(int parsed, PauliHamil h, FILE *file, char *fn, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00741">QuEST_validation.c:741</a></div></div>
<div class="ttc" id="acuda__to__hip_8h_html_a3e1dd3fa5759b34e7f0c1545c12fa72c"><div class="ttname"><a href="cuda__to__hip_8h.html#a3e1dd3fa5759b34e7f0c1545c12fa72c">file</a></div><div class="ttdeci">static void const char *const file</div><div class="ttdef"><b>Definition:</b> <a href="cuda__to__hip_8h_source.html#l00061">cuda_to_hip.h:61</a></div></div>
<div class="ttc" id="agroup__type_html_ga1c703cf89629e4e9c7023cd402d67028"><div class="ttname"><a href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a></div><div class="ttdeci">pauliOpType</div><div class="ttdoc">Codes for specifying Pauli operators.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
<div class="ttc" id="agroup__type_html_ga35b28710877c462927366fa602e591cb"><div class="ttname"><a href="group__type.html#ga35b28710877c462927366fa602e591cb">createPauliHamil</a></div><div class="ttdeci">PauliHamil createPauliHamil(int numQubits, int numSumTerms)</div><div class="ttdoc">Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01524">QuEST.c:1524</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8c_source.html#l01524">createPauliHamil()</a>, <a class="el" href="cuda__to__hip_8h_source.html#l00061">file</a>, <a class="el" href="QuEST_8h_source.html#l00283">PauliHamil::pauliCodes</a>, <a class="el" href="QuEST_8h_source.html#l00285">PauliHamil::termCoeffs</a>, <a class="el" href="QuEST__validation_8c_source.html#l00595">validateFileOpened()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00731">validateHamilFileCoeffParsed()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00722">validateHamilFileParams()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00751">validateHamilFilePauliCode()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00741">validateHamilFilePauliParsed()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l01684">createDiagonalOpFromPauliHamilFile()</a>, and <a class="el" href="test__data__structures_8cpp_source.html#l00486">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga8ba2c3388dd64d9348c3b091852d36d4" name="ga8ba2c3388dd64d9348c3b091852d36d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ba2c3388dd64d9348c3b091852d36d4">&#9670;&#160;</a></span>createQuESTEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structQuESTEnv.html">QuESTEnv</a> createQuESTEnv </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create the QuEST execution environment. </p>
<p >This should be called only once, and the environment should be freed with destroyQuESTEnv at the end of the user's code. If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__debug.html#gaf8a14ae79c3fb2c0b5f6255cc37bebf9" title="Report information about the QuEST environment.">reportQuESTEnv()</a></li>
<li><a class="el" href="group__type.html#gaeff624226629d7063a8a776958a4f991" title="Destroy the QuEST environment.">destroyQuESTEnv()</a></li>
<li><a class="el" href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...">syncQuESTEnv()</a></li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>object representing the execution environment. A single instance is used for each program </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00131">131</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>                              {</div>
<div class="line"><span class="lineno">  132</span>    </div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_struct" href="structQuESTEnv.html">QuESTEnv</a> env;</div>
<div class="line"><span class="lineno">  134</span>    </div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">// init MPI environment</span></div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordtype">int</span> rank, numRanks, initialized;</div>
<div class="line"><span class="lineno">  137</span>    MPI_Initialized(&amp;initialized);</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">if</span> (!initialized){</div>
<div class="line"><span class="lineno">  139</span>        MPI_Init(NULL, NULL);</div>
<div class="line"><span class="lineno">  140</span>        MPI_Comm_size(MPI_COMM_WORLD, &amp;numRanks);</div>
<div class="line"><span class="lineno">  141</span>        MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>        env.<a class="code hl_variable" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>=rank;</div>
<div class="line"><span class="lineno">  144</span>        env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>=numRanks;</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  147</span>        </div>
<div class="line"><span class="lineno">  148</span>        printf(<span class="stringliteral">&quot;ERROR: Trying to initialize QuESTEnv multiple times. Ignoring...\n&quot;</span>);</div>
<div class="line"><span class="lineno">  149</span>        </div>
<div class="line"><span class="lineno">  150</span>        <span class="comment">// ensure env is initialised anyway, so the compiler is happy</span></div>
<div class="line"><span class="lineno">  151</span>        MPI_Comm_size(MPI_COMM_WORLD, &amp;numRanks);</div>
<div class="line"><span class="lineno">  152</span>        MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div>
<div class="line"><span class="lineno">  153</span>        env.<a class="code hl_variable" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>=rank;</div>
<div class="line"><span class="lineno">  154</span>        env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>=numRanks;</div>
<div class="line"><span class="lineno">  155</span>        }</div>
<div class="line"><span class="lineno">  156</span>    </div>
<div class="line"><span class="lineno">  157</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ad893327ebd2123508493d445868bfcd7">validateNumRanks</a>(env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, __func__);</div>
<div class="line"><span class="lineno">  158</span>    </div>
<div class="line"><span class="lineno">  159</span>    env.<a class="code hl_variable" href="structQuESTEnv.html#a66feaa60d3adc7dcf6f8b66514989356">seeds</a> = NULL;</div>
<div class="line"><span class="lineno">  160</span>    env.<a class="code hl_variable" href="structQuESTEnv.html#a46e67e1a5ab930e04ff59f83f1d8630d">numSeeds</a> = 0;</div>
<div class="line"><span class="lineno">  161</span>        <a class="code hl_function" href="group__debug.html#gae53fad7ebafccf236ad62b41e3244214">seedQuESTDefault</a>(&amp;env);</div>
<div class="line"><span class="lineno">  162</span>    </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">return</span> env;</div>
<div class="line"><span class="lineno">  164</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_ad893327ebd2123508493d445868bfcd7"><div class="ttname"><a href="QuEST__validation_8c.html#ad893327ebd2123508493d445868bfcd7">validateNumRanks</a></div><div class="ttdeci">void validateNumRanks(int numRanks, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00357">QuEST_validation.c:357</a></div></div>
<div class="ttc" id="agroup__debug_html_gae53fad7ebafccf236ad62b41e3244214"><div class="ttname"><a href="group__debug.html#gae53fad7ebafccf236ad62b41e3244214">seedQuESTDefault</a></div><div class="ttdeci">void seedQuESTDefault(QuESTEnv *env)</div><div class="ttdoc">Seeds the random number generator with the (master node) current time and process ID.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01759">QuEST.c:1759</a></div></div>
<div class="ttc" id="astructQuESTEnv_html"><div class="ttname"><a href="structQuESTEnv.html">QuESTEnv</a></div><div class="ttdoc">Information about the environment the program is running in.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00383">QuEST.h:384</a></div></div>
<div class="ttc" id="astructQuESTEnv_html_a46e67e1a5ab930e04ff59f83f1d8630d"><div class="ttname"><a href="structQuESTEnv.html#a46e67e1a5ab930e04ff59f83f1d8630d">QuESTEnv::numSeeds</a></div><div class="ttdeci">int numSeeds</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00388">QuEST.h:388</a></div></div>
<div class="ttc" id="astructQuESTEnv_html_a66feaa60d3adc7dcf6f8b66514989356"><div class="ttname"><a href="structQuESTEnv.html#a66feaa60d3adc7dcf6f8b66514989356">QuESTEnv::seeds</a></div><div class="ttdeci">unsigned long int * seeds</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00387">QuEST.h:387</a></div></div>
<div class="ttc" id="astructQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00385">QuEST.h:385</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__gpu_8cu_source.html#l00433">GPUExists()</a>, <a class="el" href="QuEST_8h_source.html#l00386">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00388">QuESTEnv::numSeeds</a>, <a class="el" href="QuEST_8h_source.html#l00385">QuESTEnv::rank</a>, <a class="el" href="QuEST_8c_source.html#l01759">seedQuESTDefault()</a>, <a class="el" href="QuEST_8h_source.html#l00387">QuESTEnv::seeds</a>, <a class="el" href="QuEST__validation_8c_source.html#l01114">validateGPUExists()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00357">validateNumRanks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00034">main()</a>.</p>

</div>
</div>
<a id="ga3392816c0643414165c2f5caeec17df0" name="ga3392816c0643414165c2f5caeec17df0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3392816c0643414165c2f5caeec17df0">&#9670;&#160;</a></span>createQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structQureg.html">Qureg</a> createQureg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a state-vector <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> object representing a set of qubits which will remain in a pure state. </p>
<p >Allocates space for a state-vector of complex amplitudes, which assuming a single <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> floating-point number requires <b>qrealBytes</b>, requires memory  </p><p class="formulaDsp">
\[ 
     \text{qrealBytes} \times 2 \times 2^\text{numQubits}\;\;\text{(bytes)},
\]
</p>
<p> though there are additional memory costs in GPU and distributed modes.</p>
<p >The returned <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> begins in the zero state, as produced by <a class="el" href="group__init.html#ga2f049055d4a51d0ea4d1a43b5234dedb" title="Initialise qureg into the zero state.">initZeroState()</a>.</p>
<p >Once created, the following <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> fields are relevant in all backends:</p><ul>
<li><a class="el" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">Qureg.numQubitsRepresented</a></li>
<li><a class="el" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79" title="Whether this instance is a density-state representation.">Qureg.isDensityMatrix</a></li>
</ul>
<blockquote class="doxtable">
<p >&zwj;<a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> <code>env</code> must be prior created with <a class="el" href="group__type.html#ga8ba2c3388dd64d9348c3b091852d36d4" title="Create the QuEST execution environment.">createQuESTEnv()</a>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md12"></a>
Serial</h3>
<p >In serial and local (non-distributed) multithreaded modes, a state-vector <code><a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></code> costs only the memory above. For example, at double precision (<a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a> <b>= 2</b>, <b>qrealBytes = 8</b>), the memory costs are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><code>numQubits</code>   </th><th class="markdownTableHeadNone">memory    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">16 KiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">16   </td><td class="markdownTableBodyNone">1 MiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">16 MiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">26   </td><td class="markdownTableBodyNone">1 GiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">16 GiB   </td></tr>
</table>
<p >Individual amplitudes should be fetched and modified with functions like <a class="el" href="group__calc.html#ga30d6f8b7c766c9c9914b2c61a2fc0def" title="Get the complex amplitude at a given index in the state vector.">getAmp()</a> and <a class="el" href="group__init.html#gabc0c64f8adf307d2a44184dc0f8ca66e" title="Overwrites a contiguous subset of the amplitudes in state-vector qureg, with those passed in reals an...">setAmps()</a>. However, it is sometimes useful to access the state-vector directly, for example to create your own low-level (high performance) multithreaded functions. In those instants, <a class="el" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">Qureg.stateVec</a> can be accessed directly, storing the real and imaginary components of the state-vector amplitudes in:</p><ul>
<li><code>Qureg.stateVec.real</code></li>
<li><code>Qureg.stateVec.imag</code></li>
</ul>
<p >The total number of amplitudes in the state-vector is</p><ul>
<li><a class="el" href="structQureg.html#adef4935cac95763c29164cf99b144ed4" title="Total number of amplitudes, which are possibly distributed among machines.">Qureg.numAmpsTotal</a></li>
</ul>
<p >For example, </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structQureg.html">Qureg</a> qureg = <a class="code hl_function" href="group__type.html#ga3392816c0643414165c2f5caeec17df0">createQureg</a>(10, env);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ruin a perfectly good state-vector</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;qureg.<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>; i++) {</div>
<div class="line">    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] = rand();</div>
<div class="line">    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] = rand(); </div>
<div class="line">}</div>
<div class="ttc" id="agroup__type_html_ga3392816c0643414165c2f5caeec17df0"><div class="ttname"><a href="group__type.html#ga3392816c0643414165c2f5caeec17df0">createQureg</a></div><div class="ttdeci">Qureg createQureg(int numQubits, QuESTEnv env)</div><div class="ttdoc">Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00036">QuEST.c:36</a></div></div>
<div class="ttc" id="astructQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00362">QuEST.h:362</a></div></div>
<div class="ttc" id="astructQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00355">QuEST.h:355</a></div></div>
</div><!-- fragment --><p> <br  />
</p>
<h3><a class="anchor" id="autotoc_md13"></a>
GPU</h3>
<p >In GPU-accelerated mode, an <em>additional</em> state-vector is created in GPU memory. Therefore both RAM and VRAM must be of sufficient memory to store the state-vector, each of the size indicated in the Serial table above.</p>
<blockquote class="doxtable">
<p >&zwj;Note that many GPUs do not support quad precision <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>. </p>
</blockquote>
<p>Individual amplitudes of the created <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> should be fetched and modified with functions like <a class="el" href="group__calc.html#ga30d6f8b7c766c9c9914b2c61a2fc0def" title="Get the complex amplitude at a given index in the state vector.">getAmp()</a> and <a class="el" href="group__init.html#gabc0c64f8adf307d2a44184dc0f8ca66e" title="Overwrites a contiguous subset of the amplitudes in state-vector qureg, with those passed in reals an...">setAmps()</a>. This is especially important since the GPU state-vector can be accessed directly, and changes to <a class="el" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">Qureg.stateVec</a> will be ignored and overwritten. To modify the state-vector "directly", one must use <a class="el" href="group__debug.html#ga924ef2dbda6b733b4041270077c76ece" title="In GPU mode, this copies the state-vector (or density matrix) from GPU memory (qureg....">copyStateFromGPU()</a> and <a class="el" href="group__debug.html#ga11448560006dd165128e404b54ebb2f7" title="In GPU mode, this copies the state-vector (or density matrix) from RAM (qureg.stateVec) to VRAM / GPU...">copyStateToGPU()</a> before and after.</p>
<p >For example, </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structQureg.html">Qureg</a> qureg = <a class="code hl_function" href="group__type.html#ga3392816c0643414165c2f5caeec17df0">createQureg</a>(10, env);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ruin a perfectly good state-vector</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;qureg.<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>; i++) {</div>
<div class="line">    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] = rand();</div>
<div class="line">    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] = rand(); </div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="group__debug.html#ga11448560006dd165128e404b54ebb2f7">copyStateToGPU</a>();</div>
<div class="ttc" id="agroup__debug_html_ga11448560006dd165128e404b54ebb2f7"><div class="ttname"><a href="group__debug.html#ga11448560006dd165128e404b54ebb2f7">copyStateToGPU</a></div><div class="ttdeci">void copyStateToGPU(Qureg qureg)</div><div class="ttdoc">In GPU mode, this copies the state-vector (or density matrix) from RAM (qureg.stateVec) to VRAM / GPU...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00043">QuEST_cpu.c:43</a></div></div>
</div><!-- fragment --><p> <br  />
</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Distributed</h3>
<p >In distributed mode, the state-vector is uniformly partitioned between the <b>N</b> distributed nodes.</p>
<blockquote class="doxtable">
<p >&zwj;Only a power-of-2 number of nodes <b>N</b> may be used (e.g. <b>N = 1, 2, 4, 8, </b>...). There must additionally be at least 1 amplitude of a state-vector stored on each node. This means one cannot create a state-vector <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> with fewer than \(\log_2(\text{N})\) qubits. </p>
</blockquote>
<p>In addition to <a class="el" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">Qureg.stateVec</a>, additional memory is allocated on each node for communication buffers, of size equal to the state-vector partition. Hence the total memory <em>per-node</em> required is:  </p><p class="formulaDsp">
\[ 
     2 \times \text{qrealBytes} \times 2 \times 2^\text{numQubits}/N  \;\;\text{(bytes)},
\]
</p>
<p >For example, at double precision (<a class="el" href="group__type.html#ga626676e623baa3de702c185736018b2c" title="Sets the precision of qreal and qcomp floating-point numbers, and hence the numerical precision of Qu...">QuEST_PREC</a> <b>= 2</b>, <b>qrealBytes = 8</b>), the memory costs are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><code>numQubits</code>   </th><th class="markdownTableHeadNone" colspan="5">memory per node    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><b>N = 2</b>   </td><td class="markdownTableBodyNone"><b>N = 4</b>   </td><td class="markdownTableBodyNone"><b>N = 8</b>   </td><td class="markdownTableBodyNone"><b>N = 16</b>   </td><td class="markdownTableBodyNone"><b>N = 32</b>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">16 KiB   </td><td class="markdownTableBodyNone">8 KiB   </td><td class="markdownTableBodyNone">4 KiB   </td><td class="markdownTableBodyNone">2 KiB   </td><td class="markdownTableBodyNone">1 KiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">16 MiB   </td><td class="markdownTableBodyNone">8 MiB   </td><td class="markdownTableBodyNone">4 MiB   </td><td class="markdownTableBodyNone">2 MiB   </td><td class="markdownTableBodyNone">1 MiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">16 GiB   </td><td class="markdownTableBodyNone">8 GiB   </td><td class="markdownTableBodyNone">4 GiB   </td><td class="markdownTableBodyNone">2 GiB   </td><td class="markdownTableBodyNone">1 GiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">40   </td><td class="markdownTableBodyNone">16 TiB   </td><td class="markdownTableBodyNone">8 TiB   </td><td class="markdownTableBodyNone">4 TiB   </td><td class="markdownTableBodyNone">2 TiB   </td><td class="markdownTableBodyNone">1 TiB   </td></tr>
</table>
<p >State-vector amplitudes should be set and modified using <a class="el" href="group__calc.html#ga30d6f8b7c766c9c9914b2c61a2fc0def" title="Get the complex amplitude at a given index in the state vector.">getAmp()</a> and <a class="el" href="group__init.html#gabc0c64f8adf307d2a44184dc0f8ca66e" title="Overwrites a contiguous subset of the amplitudes in state-vector qureg, with those passed in reals an...">setAmps()</a>. Direct modification is possible, but should be done extremely carefully, since each node only stores a <em>partition</em> of the full state-vector, which itself mightn't fit on any single node. Furthermore, an asynchronous MPI process may may unexpectedly modify local amplitudes; avoid this with <a class="el" href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...">syncQuESTEnv()</a>.</p>
<p >The fields relevant to distribution are:</p>
<ul>
<li><a class="el" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI version,...">Qureg.numAmpsPerChunk</a>: the length of <a class="el" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">Qureg.stateVec</a> (<code>.real</code> and <code>.imag</code>) on each node.</li>
<li><a class="el" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state vector.">Qureg.chunkId</a>: the id of the node, from <b>0</b> to <b>N-1</b>.</li>
</ul>
<p >Therefore, this code is valid </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div>
<div class="line"><span class="comment">// set state |i&gt; to have amplitude i</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; i++)</div>
<div class="line">    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] = i + qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="ttc" id="agroup__debug_html_ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00166">QuEST_cpu_distributed.c:166</a></div></div>
<div class="ttc" id="astructQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version,...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00353">QuEST.h:353</a></div></div>
<div class="ttc" id="astructQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00357">QuEST.h:357</a></div></div>
</div><!-- fragment --><p> while the following erroneous code would cause a segmentation fault: </p><div class="fragment"><div class="line"><span class="comment">// incorrectly attempt to set state |i&gt; to have amplitude i</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;qureg.<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>; i++)</div>
<div class="line">    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] = i;</div>
</div><!-- fragment --><p> <br  />
</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c" title="Creates a density matrix Qureg object representing a set of qubits which can enter noisy and mixed st...">createDensityQureg()</a> to create a density matrix of the equivalent number of qubits, which can enter noisy states.</li>
<li><a class="el" href="group__type.html#gabd07eee133dcd4e6ae7c2d2ce4c42978" title="Create a new Qureg which is an exact clone of the passed qureg, which can be either a state-vector or...">createCloneQureg()</a> to create a new qureg of the size and state of an existing qureg.</li>
<li><a class="el" href="group__type.html#ga8e1e6ad3254892edc2ee08712ea9d692" title="Deallocate a Qureg, freeing its memory.">destroyQureg()</a> to free the allocated <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> memory.</li>
<li><a class="el" href="group__debug.html#ga97d96af7c7ea7b31e32cbe3b25377e09" title="Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.">reportQuregParams()</a> to print information about a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>.</li>
<li><a class="el" href="group__debug.html#ga924ef2dbda6b733b4041270077c76ece" title="In GPU mode, this copies the state-vector (or density matrix) from GPU memory (qureg....">copyStateFromGPU()</a> and <a class="el" href="group__debug.html#ga11448560006dd165128e404b54ebb2f7" title="In GPU mode, this copies the state-vector (or density matrix) from RAM (qureg.stateVec) to VRAM / GPU...">copyStateToGPU()</a> for directly modifying state-vectors in GPU mode.</li>
<li><a class="el" href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...">syncQuESTEnv()</a> for directly modifying state-vectors in distributed mode.</li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>an object representing the set of qubits </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>numQubits</code> &lt;= 0</li>
<li>if <code>numQubits</code> is so large that the number of amplitudes cannot fit in a long long int type,</li>
<li>if in distributed mode, there are more nodes than elements in the would-be state-vector </li>
</ul>
</td></tr>
    <tr><td class="paramname">exit</td><td><ul>
<li>if in GPU mode, but GPU memory cannot be allocated. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd>
<dd>
Tyson Jones (validation, doc) </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00036">36</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span>                                               {</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a45428d4a49b8798a8d25a7155f622238">validateNumQubitsInQureg</a>(numQubits, env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, __func__);</div>
<div class="line"><span class="lineno">   38</span>    </div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_struct" href="structQureg.html">Qureg</a> qureg;</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a>(&amp;qureg, numQubits, env);</div>
<div class="line"><span class="lineno">   41</span>    qureg.<a class="code hl_variable" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a> = 0;</div>
<div class="line"><span class="lineno">   42</span>    qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a> = numQubits;</div>
<div class="line"><span class="lineno">   43</span>    qureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = numQubits;</div>
<div class="line"><span class="lineno">   44</span>    </div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_function" href="QuEST__qasm_8c.html#aa5f05644a6cea13e00f828658bcf7a68">qasm_setup</a>(&amp;qureg);</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_function" href="group__init.html#ga2f049055d4a51d0ea4d1a43b5234dedb">initZeroState</a>(qureg); <span class="comment">// safe call to public function</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">return</span> qureg;</div>
<div class="line"><span class="lineno">   48</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8c_source.html#l00113">initZeroState()</a>, <a class="el" href="QuEST_8h_source.html#l00346">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00350">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00386">QuESTEnv::numRanks</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00056">qasm_setup()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01296">statevec_createQureg()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00371">validateNumQubitsInQureg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__calculations_8cpp_source.html#l00015">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga3129b2a427fb0ea52387b63088d0068b" name="ga3129b2a427fb0ea52387b63088d0068b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3129b2a427fb0ea52387b63088d0068b">&#9670;&#160;</a></span>createSubDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a> createSubDiagonalOp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> representing a diagonal operator which can act upon a subset of the qubits in a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>. </p>
<p >This is similar to a <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> acting upon specific qubits.</p>
<p >The resulting operator (initially all zero) need not be unitary nor Hermitian, and can be applied to any <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> of a compatible number of qubits.</p>
<blockquote class="doxtable">
<p >&zwj;This function allocates space for \(2^{\text{numQubits}}\) complex amplitudes, which are initially zero. This is the same cost as a local state-vector of equal number of qubits; see the Serial section of <a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a>. Unlike <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a>, this object is <em>not</em> distributed; instead, all nodes (during distributed simulation) store the full set of diagonal elements, similar to a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a>. </p>
</blockquote>
<p >The returned <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> must be later freed with <a class="el" href="group__type.html#ga6eaa131f0b73a53f1218e19ce4825ac3" title="Destroy a SubDiagonalOp instance created with createSubDiagonalOp().">destroySubDiagonalOp()</a>.</p>
<p >For example, the below code creates an 8x8 identity operator. </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structSubDiagonalOp.html">SubDiagonalOp</a> op = <a class="code hl_function" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b">createSubDiagonalOp</a>(3);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;op.<a class="code hl_variable" href="structSubDiagonalOp.html#a41e794cee30824373f0441153fa8aa36">numElems</a>; i++)</div>
<div class="line">     op.<a class="code hl_variable" href="structSubDiagonalOp.html#a7574f5598b97ff42a3d5238087722026">real</a>[i] = 1;</div>
<div class="ttc" id="agroup__type_html_ga3129b2a427fb0ea52387b63088d0068b"><div class="ttname"><a href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b">createSubDiagonalOp</a></div><div class="ttdeci">SubDiagonalOp createSubDiagonalOp(int numQubits)</div><div class="ttdoc">Creates a SubDiagonalOp representing a diagonal operator which can act upon a subset of the qubits in...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01695">QuEST.c:1695</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html"><div class="ttname"><a href="structSubDiagonalOp.html">SubDiagonalOp</a></div><div class="ttdoc">Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00323">QuEST.h:324</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html_a41e794cee30824373f0441153fa8aa36"><div class="ttname"><a href="structSubDiagonalOp.html#a41e794cee30824373f0441153fa8aa36">SubDiagonalOp::numElems</a></div><div class="ttdeci">long long int numElems</div><div class="ttdoc">The number of diagonal elements, i.e. 2^numQubits.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00328">QuEST.h:328</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html_a7574f5598b97ff42a3d5238087722026"><div class="ttname"><a href="structSubDiagonalOp.html#a7574f5598b97ff42a3d5238087722026">SubDiagonalOp::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdoc">The real values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00330">QuEST.h:330</a></div></div>
</div><!-- fragment --><p> <br  />
</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__unitary.html#ga2c8946d0ea290a0ef60f10bc701bc64c" title="Apply a many-qubit unitary specified as a diagonal matrix upon a specific set of qubits of a quantum ...">diagonalUnitary()</a> to apply the created <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> upon a subset of qubits of a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a></li>
<li><a class="el" href="group__operator.html#ga56f8393f74dcf24a8d4b0f47191b38f4" title="Apply a many-qubit unitary specified as a diagonal matrix upon a specific set of qubits of a quantum ...">applyGateSubDiagonalOp()</a> to relax the numerical unitarity requirement of <a class="el" href="group__unitary.html#ga2c8946d0ea290a0ef60f10bc701bc64c" title="Apply a many-qubit unitary specified as a diagonal matrix upon a specific set of qubits of a quantum ...">diagonalUnitary()</a></li>
<li><a class="el" href="group__operator.html#ga2732669d9bc7f83a3fbd28f9fa030f1a" title="Left-apply a many-qubit a diagonal matrix upon a specific set of qubits of a quantum register.">applySubDiagonalOp()</a> to apply the <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> through left-multiplication only (as a non-unitary) upon a density matrix</li>
<li><a class="el" href="group__type.html#ga6eaa131f0b73a53f1218e19ce4825ac3" title="Destroy a SubDiagonalOp instance created with createSubDiagonalOp().">destroySubDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a></li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> instance initialised to diag(0,0,...). </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits which inform the Hilbert dimension of the returned <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>numQubits</code> &lt;= 0</li>
<li>if <code>numQubits</code> is so large that the number of elements cannot fit in a long long int type, </li>
</ul>
</td></tr>
    <tr><td class="paramname">exit</td><td><ul>
<li>if the memory could not be allocated </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01695">1695</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1695</span>                                                 {</div>
<div class="line"><span class="lineno"> 1696</span>    <a class="code hl_function" href="QuEST__validation_8c.html#aafa00c90289a19b3e2c437e1a6cb1a2a">validateNumQubitsInSubDiagOp</a>(numQubits, __func__);</div>
<div class="line"><span class="lineno"> 1697</span> </div>
<div class="line"><span class="lineno"> 1698</span>    <a class="code hl_struct" href="structSubDiagonalOp.html">SubDiagonalOp</a> op;</div>
<div class="line"><span class="lineno"> 1699</span>    op.<a class="code hl_variable" href="structSubDiagonalOp.html#af6cd52e0f020146e0019772d379c6996">numQubits</a> = numQubits;</div>
<div class="line"><span class="lineno"> 1700</span>    op.<a class="code hl_variable" href="structSubDiagonalOp.html#a41e794cee30824373f0441153fa8aa36">numElems</a> = (1LL &lt;&lt; numQubits);</div>
<div class="line"><span class="lineno"> 1701</span>    </div>
<div class="line"><span class="lineno"> 1702</span>    <span class="comment">// allocate CPU memory (initialised to zero)</span></div>
<div class="line"><span class="lineno"> 1703</span>    op.<a class="code hl_variable" href="structSubDiagonalOp.html#a7574f5598b97ff42a3d5238087722026">real</a> = (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) calloc(op.<a class="code hl_variable" href="structSubDiagonalOp.html#a41e794cee30824373f0441153fa8aa36">numElems</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>));</div>
<div class="line"><span class="lineno"> 1704</span>    op.<a class="code hl_variable" href="structSubDiagonalOp.html#abb4b987a1e075fd89c03245d089a32c5">imag</a> = (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) calloc(op.<a class="code hl_variable" href="structSubDiagonalOp.html#a41e794cee30824373f0441153fa8aa36">numElems</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>));</div>
<div class="line"><span class="lineno"> 1705</span>    </div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">return</span> op;</div>
<div class="line"><span class="lineno"> 1707</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_aafa00c90289a19b3e2c437e1a6cb1a2a"><div class="ttname"><a href="QuEST__validation_8c.html#aafa00c90289a19b3e2c437e1a6cb1a2a">validateNumQubitsInSubDiagOp</a></div><div class="ttdeci">void validateNumQubitsInSubDiagOp(int numQubits, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00399">QuEST_validation.c:399</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html_abb4b987a1e075fd89c03245d089a32c5"><div class="ttname"><a href="structSubDiagonalOp.html#abb4b987a1e075fd89c03245d089a32c5">SubDiagonalOp::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdoc">The imaginary values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00332">QuEST.h:332</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html_af6cd52e0f020146e0019772d379c6996"><div class="ttname"><a href="structSubDiagonalOp.html#af6cd52e0f020146e0019772d379c6996">SubDiagonalOp::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">The number of target qubits which this SubDiagonalOp can operate upon.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00326">QuEST.h:326</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00332">SubDiagonalOp::imag</a>, <a class="el" href="QuEST_8h_source.html#l00328">SubDiagonalOp::numElems</a>, <a class="el" href="QuEST_8h_source.html#l00326">SubDiagonalOp::numQubits</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00330">SubDiagonalOp::real</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00399">validateNumQubitsInSubDiagOp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00690">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga9df2f3d86be4a6e9aad481665e5e6753" name="ga9df2f3d86be4a6e9aad481665e5e6753"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9df2f3d86be4a6e9aad481665e5e6753">&#9670;&#160;</a></span>destroyComplexMatrixN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyComplexMatrixN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a>&#160;</td>
          <td class="paramname"><em>matr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> instance created with <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a> </p>
<p >It is invalid to attempt to destroy a matrix created with <a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2" title="Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...">getStaticComplexMatrixN()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2" title="Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...">getStaticComplexMatrixN()</a></li>
<li><a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">matr</td><td>the dynamic matrix (created with <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a>) to deallocate </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>matr</code> was not yet allocated. </li>
</ul>
</td></tr>
    <tr><td class="paramname">malloc_error</td><td><ul>
<li>if <code>matr</code> was static (created with <a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2" title="Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...">getStaticComplexMatrixN()</a>) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01495">1495</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1495</span>                                             {</div>
<div class="line"><span class="lineno"> 1496</span>    <span class="comment">/* this checks m.real/imag != NULL, which is only ever set when the mallocs </span></div>
<div class="line"><span class="lineno"> 1497</span><span class="comment">     * in createComplexMatrixN fail, which already prompts an error. Hence </span></div>
<div class="line"><span class="lineno"> 1498</span><span class="comment">     * this check if useless </span></div>
<div class="line"><span class="lineno"> 1499</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1500</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a6a3d99bc780707a90120a78a6e203792">validateMatrixInit</a>(m, __func__);</div>
<div class="line"><span class="lineno"> 1501</span>    </div>
<div class="line"><span class="lineno"> 1502</span>    <span class="keywordtype">int</span> numRows = 1 &lt;&lt; m.numQubits;</div>
<div class="line"><span class="lineno"> 1503</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r &lt; numRows; r++) {</div>
<div class="line"><span class="lineno"> 1504</span>        free(m.real[r]);</div>
<div class="line"><span class="lineno"> 1505</span>        free(m.imag[r]);</div>
<div class="line"><span class="lineno"> 1506</span>    }</div>
<div class="line"><span class="lineno"> 1507</span>    free(m.real);</div>
<div class="line"><span class="lineno"> 1508</span>    free(m.imag);</div>
<div class="line"><span class="lineno"> 1509</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00190">ComplexMatrixN::imag</a>, <a class="el" href="QuEST_8h_source.html#l00188">ComplexMatrixN::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00189">ComplexMatrixN::real</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00538">validateMatrixInit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__common_8c_source.html#l00698">densmatr_mixMultiQubitKrausMap()</a>, <a class="el" href="QuEST__common_8c_source.html#l00680">densmatr_mixTwoQubitKrausMap()</a>, and <a class="el" href="test__data__structures_8cpp_source.html#l00110">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga2c59f45fab56708f687b4104ee99bcd1" name="ga2c59f45fab56708f687b4104ee99bcd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2c59f45fab56708f687b4104ee99bcd1">&#9670;&#160;</a></span>destroyDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys a <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> created with <a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a>, freeing its memory. </p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">op</td><td>the <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> to destroy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>the <a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>op</code> was not previously created </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01650">1650</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1650</span>                                                    {</div>
<div class="line"><span class="lineno"> 1651</span>    <span class="comment">// env accepted for API consistency</span></div>
<div class="line"><span class="lineno"> 1652</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ac5bd32bc24176e616a288ae04752fc9c">validateDiagOpInit</a>(op, __func__);</div>
<div class="line"><span class="lineno"> 1653</span>    </div>
<div class="line"><span class="lineno"> 1654</span>    <a class="code hl_function" href="QuEST__internal_8h.html#af798bb01f922804016c4c5bc8d0a580f">agnostic_destroyDiagonalOp</a>(op);</div>
<div class="line"><span class="lineno"> 1655</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_af798bb01f922804016c4c5bc8d0a580f"><div class="ttname"><a href="QuEST__internal_8h.html#af798bb01f922804016c4c5bc8d0a580f">agnostic_destroyDiagonalOp</a></div><div class="ttdeci">void agnostic_destroyDiagonalOp(DiagonalOp op)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01407">QuEST_cpu.c:1407</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_ac5bd32bc24176e616a288ae04752fc9c"><div class="ttname"><a href="QuEST__validation_8c.html#ac5bd32bc24176e616a288ae04752fc9c">validateDiagOpInit</a></div><div class="ttdeci">void validateDiagOpInit(DiagonalOp op, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00767">QuEST_validation.c:767</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l01407">agnostic_destroyDiagonalOp()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00767">validateDiagOpInit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__calculations_8cpp_source.html#l00111">TEST_CASE()</a>, <a class="el" href="QuEST__validation_8c_source.html#l01090">validateDiagonalOpAllocation()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l01100">validateDiagonalOpGPUAllocation()</a>.</p>

</div>
</div>
<a id="gac1c8ed909b33bd55ae680901006051b6" name="gac1c8ed909b33bd55ae680901006051b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1c8ed909b33bd55ae680901006051b6">&#9670;&#160;</a></span>destroyPauliHamil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyPauliHamil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td>
          <td class="paramname"><em>hamil</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy a <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> instance, created with either <a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a> or <a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hamil</td><td>a dynamic <code><a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a></code> instantiation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01540">1540</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1540</span>                                     {</div>
<div class="line"><span class="lineno"> 1541</span>    </div>
<div class="line"><span class="lineno"> 1542</span>    free(h.termCoeffs);</div>
<div class="line"><span class="lineno"> 1543</span>    free(h.pauliCodes);</div>
<div class="line"><span class="lineno"> 1544</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00283">PauliHamil::pauliCodes</a>, and <a class="el" href="QuEST_8h_source.html#l00285">PauliHamil::termCoeffs</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l01684">createDiagonalOpFromPauliHamilFile()</a>, <a class="el" href="test__calculations_8cpp_source.html#l00183">TEST_CASE()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00785">validateDiagPauliHamilFromFile()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00731">validateHamilFileCoeffParsed()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00751">validateHamilFilePauliCode()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00741">validateHamilFilePauliParsed()</a>.</p>

</div>
</div>
<a id="gaeff624226629d7063a8a776958a4f991" name="gaeff624226629d7063a8a776958a4f991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeff624226629d7063a8a776958a4f991">&#9670;&#160;</a></span>destroyQuESTEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the QuEST environment. </p>
<p >If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga8ba2c3388dd64d9348c3b091852d36d4" title="Create the QuEST execution environment.">createQuESTEnv()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00176">176</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>                                  {</div>
<div class="line"><span class="lineno">  177</span>    free(env.<a class="code hl_variable" href="structQuESTEnv.html#a66feaa60d3adc7dcf6f8b66514989356">seeds</a>);</div>
<div class="line"><span class="lineno">  178</span>    </div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordtype">int</span> finalized;</div>
<div class="line"><span class="lineno">  180</span>    MPI_Finalized(&amp;finalized);</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">if</span> (!finalized) MPI_Finalize();</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;ERROR: Trying to close QuESTEnv multiple times. Ignoring\n&quot;</span>);</div>
<div class="line"><span class="lineno">  183</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00387">QuESTEnv::seeds</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00034">main()</a>.</p>

</div>
</div>
<a id="ga8e1e6ad3254892edc2ee08712ea9d692" name="ga8e1e6ad3254892edc2ee08712ea9d692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8e1e6ad3254892edc2ee08712ea9d692">&#9670;&#160;</a></span>destroyQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate a <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a>, freeing its memory. </p>
<p >This frees all memory bound to <code>qureg</code>, including its state-vector or density matrix in RAM, in VRAM (in GPU mode), and communication buffers (in distributed mode).</p>
<p >The <code>qureg</code> must have been previously created with <a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a>, <a class="el" href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c" title="Creates a density matrix Qureg object representing a set of qubits which can enter noisy and mixed st...">createDensityQureg()</a> or <a class="el" href="group__type.html#gabd07eee133dcd4e6ae7c2d2ce4c42978" title="Create a new Qureg which is an exact clone of the passed qureg, which can be either a state-vector or...">createCloneQureg()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga3392816c0643414165c2f5caeec17df0" title="Creates a state-vector Qureg object representing a set of qubits which will remain in a pure state.">createQureg()</a></li>
<li><a class="el" href="group__type.html#ga93e55b6650b408abb30a1d4a8bce757c" title="Creates a density matrix Qureg object representing a set of qubits which can enter noisy and mixed st...">createDensityQureg()</a></li>
<li><a class="el" href="group__type.html#gabd07eee133dcd4e6ae7c2d2ce4c42978" title="Create a new Qureg which is an exact clone of the passed qureg, which can be either a state-vector or...">createCloneQureg()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>the <a class="el" href="structQureg.html" title="Represents a system of qubits.">Qureg</a> to be destroyed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>the <a class="el" href="structQuESTEnv.html" title="Information about the environment the program is running in.">QuESTEnv</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd>
<dd>
Tyson Jones (improved doc) </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00077">77</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>                                             {</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a>(qureg, env);</div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_function" href="QuEST__qasm_8c.html#ae5ef90741274785eb1ebbbe828b7df8a">qasm_free</a>(qureg);</div>
<div class="line"><span class="lineno">   80</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_a2a52ad9f9ad9b2fd6a76f6d433b3b217"><div class="ttname"><a href="QuEST__internal_8h.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a></div><div class="ttdeci">void statevec_destroyQureg(Qureg qureg, QuESTEnv env)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01321">QuEST_cpu.c:1321</a></div></div>
<div class="ttc" id="aQuEST__qasm_8c_html_ae5ef90741274785eb1ebbbe828b7df8a"><div class="ttname"><a href="QuEST__qasm_8c.html#ae5ef90741274785eb1ebbbe828b7df8a">qasm_free</a></div><div class="ttdeci">void qasm_free(Qureg qureg)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__qasm_8c_source.html#l00882">QuEST_qasm.c:882</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__qasm_8c_source.html#l00882">qasm_free()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01321">statevec_destroyQureg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__calculations_8cpp_source.html#l00015">TEST_CASE()</a>, <a class="el" href="QuEST__validation_8c_source.html#l01054">validateQuregAllocation()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l01073">validateQuregGPUAllocation()</a>.</p>

</div>
</div>
<a id="ga6eaa131f0b73a53f1218e19ce4825ac3" name="ga6eaa131f0b73a53f1218e19ce4825ac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6eaa131f0b73a53f1218e19ce4825ac3">&#9670;&#160;</a></span>destroySubDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroySubDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy a <a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> instance created with <a class="el" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b" title="Creates a SubDiagonalOp representing a diagonal operator which can act upon a subset of the qubits in...">createSubDiagonalOp()</a>. </p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#ga3129b2a427fb0ea52387b63088d0068b" title="Creates a SubDiagonalOp representing a diagonal operator which can act upon a subset of the qubits in...">createSubDiagonalOp()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">op</td><td><a class="el" href="structSubDiagonalOp.html" title="Represents a diagonal complex operator of a smaller dimension than the full Hilbert state of a Qureg.">SubDiagonalOp</a> to destroy </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">malloc_error</td><td><ul>
<li>if <code>op</code> was not prior created </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01709">1709</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1709</span>                                            {</div>
<div class="line"><span class="lineno"> 1710</span>    free(op.<a class="code hl_variable" href="structSubDiagonalOp.html#a7574f5598b97ff42a3d5238087722026">real</a>);</div>
<div class="line"><span class="lineno"> 1711</span>    free(op.<a class="code hl_variable" href="structSubDiagonalOp.html#abb4b987a1e075fd89c03245d089a32c5">imag</a>);</div>
<div class="line"><span class="lineno"> 1712</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00332">SubDiagonalOp::imag</a>, and <a class="el" href="QuEST_8h_source.html#l00330">SubDiagonalOp::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00690">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga429f1b90b3ef06c786dec8c7f0eda4ce" name="ga429f1b90b3ef06c786dec8c7f0eda4ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga429f1b90b3ef06c786dec8c7f0eda4ce">&#9670;&#160;</a></span>initComplexMatrixN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initComplexMatrixN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a>&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>real</em>[][1&lt;&lt; m.numQubits], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>imag</em>[][1&lt;&lt; m.numQubits]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises a <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a> instance to have the passed <code>real</code> and <code>imag</code> values. </p>
<p >This allows succint population of any-sized <a class="el" href="structComplexMatrixN.html" title="Represents a general 2^N by 2^N matrix of complex numbers.">ComplexMatrixN</a>, e.g. through 2D arrays: </p><pre class="fragment">ComplexMatrixN m = createComplexMatrixN(3);
initComplexMatrixN(m, 
    (qreal[8][8]) {{1,2,3,4,5,6,7,8}, {0}},
    (qreal[8][8]) {{0}});
</pre><p> <code>m</code> can be created by either <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a> or <a class="el" href="group__type.html#ga927beeee2ba3b110f33ebb440c154ae2" title="Creates a ComplexMatrixN struct which lives in the stack and so does not need freeing,...">getStaticComplexMatrixN()</a>.</p>
<p >This function is only callable in C, since C++ signatures cannot contain variable-length 2D arrays</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>the matrix to initialise </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">real</td><td>matrix of real values; can be 2D array of array of pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imag</td><td>matrix of imaginary values; can be 2D array of array of pointers </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>m</code> has not been allocated (e.g. with <a class="el" href="group__type.html#ga815103261fb22ea9690e1427571df00e" title="Allocate dynamic memory for a square complex matrix of any size, which can be passed to functions lik...">createComplexMatrixN()</a>) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01512">1512</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1512</span>                                                                                                  {</div>
<div class="line"><span class="lineno"> 1513</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a6a3d99bc780707a90120a78a6e203792">validateMatrixInit</a>(m, __func__);</div>
<div class="line"><span class="lineno"> 1514</span>    </div>
<div class="line"><span class="lineno"> 1515</span>    <span class="keywordtype">int</span> dim = 1 &lt;&lt; m.<a class="code hl_variable" href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">numQubits</a>;</div>
<div class="line"><span class="lineno"> 1516</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dim; i++)</div>
<div class="line"><span class="lineno"> 1517</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;dim; j++) {</div>
<div class="line"><span class="lineno"> 1518</span>            m.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>[i][j] = re[i][j];</div>
<div class="line"><span class="lineno"> 1519</span>            m.<a class="code hl_variable" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>[i][j] = im[i][j];</div>
<div class="line"><span class="lineno"> 1520</span>        }</div>
<div class="line"><span class="lineno"> 1521</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00190">ComplexMatrixN::imag</a>, <a class="el" href="QuEST_8h_source.html#l00188">ComplexMatrixN::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00189">ComplexMatrixN::real</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00538">validateMatrixInit()</a>.</p>

</div>
</div>
<a id="ga12a6c59ebbfba8bdb9453a4138027d46" name="ga12a6c59ebbfba8bdb9453a4138027d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga12a6c59ebbfba8bdb9453a4138027d46">&#9670;&#160;</a></span>initDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>imag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overwrites the entire <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> <code>op</code> with the given <code>real</code> and <code>imag</code> complex elements. </p>
<p >Both <code>real</code> and <code>imag</code> must have length equal to <b>pow(2, </b><code>op.numQubits</code><b>)</b>.</p>
<p >In GPU mode, this updates both the RAM (<code>op.real</code> and <code>op.imag</code>) <em>and</em> persistent GPU memory; there is no need to call <a class="el" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9" title="Update the GPU memory with the current values in op.real and op.imag.">syncDiagonalOp()</a> afterward.</p>
<p >In distributed mode, this function assumes <code>real</code> and <code>imag</code> exist fully on every node. For <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> which are too large to fit into a single node, use <a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a> or <a class="el" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9" title="Update the GPU memory with the current values in op.real and op.imag.">syncDiagonalOp()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a></li>
<li><a class="el" href="group__type.html#ga2ecd67e0de9efcbbe37afbad28a8ffad" title="Populates the diagonal operator op to be equivalent to the given Pauli Hamiltonian hamil,...">initDiagonalOpFromPauliHamil()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">op</td><td>the diagonal operator to modify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">real</td><td>the real components of the full set of new elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imag</td><td>the imaginary components of the full set of new elements </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>op</code> was not created </li>
</ul>
</td></tr>
    <tr><td class="paramname">segmentation-fault</td><td><ul>
<li>if either <code>real</code> or <code>imag</code> have length smaller than <b>pow(2, </b><code>op.numQubits</code><b>)</b> </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01663">1663</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1663</span>                                                             {</div>
<div class="line"><span class="lineno"> 1664</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ac5bd32bc24176e616a288ae04752fc9c">validateDiagOpInit</a>(op, __func__);</div>
<div class="line"><span class="lineno"> 1665</span>    </div>
<div class="line"><span class="lineno"> 1666</span>    <a class="code hl_function" href="QuEST__internal_8h.html#ab58d6d599c7a729255b1f8eeded663f3">agnostic_setDiagonalOpElems</a>(op, 0, real, imag, 1LL &lt;&lt; op.<a class="code hl_variable" href="structDiagonalOp.html#a5131eeb67aafb4c19ac98270c3266742">numQubits</a>);</div>
<div class="line"><span class="lineno"> 1667</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_ab58d6d599c7a729255b1f8eeded663f3"><div class="ttname"><a href="QuEST__internal_8h.html#ab58d6d599c7a729255b1f8eeded663f3">agnostic_setDiagonalOpElems</a></div><div class="ttdeci">void agnostic_setDiagonalOpElems(DiagonalOp op, long long int startInd, qreal *real, qreal *imag, long long int numElems)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l04259">QuEST_cpu.c:4259</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a5131eeb67aafb4c19ac98270c3266742"><div class="ttname"><a href="structDiagonalOp.html#a5131eeb67aafb4c19ac98270c3266742">DiagonalOp::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">The number of qubits this operator can act on (informing its size)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00302">QuEST.h:302</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l04259">agnostic_setDiagonalOpElems()</a>, <a class="el" href="QuEST_8h_source.html#l00302">DiagonalOp::numQubits</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00767">validateDiagOpInit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00834">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ga2ecd67e0de9efcbbe37afbad28a8ffad" name="ga2ecd67e0de9efcbbe37afbad28a8ffad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2ecd67e0de9efcbbe37afbad28a8ffad">&#9670;&#160;</a></span>initDiagonalOpFromPauliHamil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initDiagonalOpFromPauliHamil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td>
          <td class="paramname"><em>hamil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Populates the diagonal operator <code>op</code> to be equivalent to the given Pauli Hamiltonian <code>hamil</code>, assuming <code>hamil</code> contains only <code>PAULI_Z</code> operators. </p>
<p >Given a <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> <code>hamil</code> featuring only <code>PAULI_Z</code> and <code>PAULI_I</code>, with term coefficients \(\{\lambda_j\}\), which hence has form  </p><p class="formulaDsp">
\[
     \begin{aligned}
     \text{hamil} &amp;= \sum\limits_j^{\text{numSumTerms}} \lambda_j
                     \bigotimes\limits_{k_j} \hat{Z}_k \\
     &amp;\equiv \begin{pmatrix}
             r_1 \\ &amp; r_2 \\ &amp; &amp; r_3 \\ &amp; &amp; &amp; \ddots \\ &amp; &amp; &amp; &amp; r_{2^{\,\text{numQubits}}}
         \end{pmatrix},
     \end{aligned}
\]
</p>
<p> this function modifies <code>op</code> to  </p><p class="formulaDsp">
\[
     \text{op} \; \rightarrow \; \text{diag}
         \big( \; r_1, \; r_2, \; r_3, \; \dots, \; r_{2^{\,\text{numQubits}}} \, \big),
\]
</p>
<p> where the real amplitudes have form  </p><p class="formulaDsp">
\[
      r_i = \sum\limits_j \, s_{ij} \, \lambda_j, \;\;\;\; s_{ij} = \pm  1 \,.
\]
</p>
<p> This is useful since calculations with <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> are significantly faster than the equivalent calculations with a general <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a>. For example, <a class="el" href="group__operator.html#gad2e953390342cd361cfb4064d47715e6" title="Apply a diagonal operator, which is possibly non-unitary and non-Hermitian, to the entire qureg.">applyDiagonalOp()</a> requires a factor <code>numSumTerms * numQubits</code> fewer operations than <a class="el" href="group__operator.html#ga54d4e589468002bdc998200ae45e7312" title="Modifies outQureg to be the result of applying PauliHamil (a Hermitian but not necessarily unitary op...">applyPauliHamil()</a>.</p>
<blockquote class="doxtable">
<p >&zwj;In distributed mode, each node will contain only a sub-partition of the full diagonal matrix. <br  />
 In GPU mode, both the CPU and GPU memory copies of <code>op</code> will be updated, so there is no need to call <a class="el" href="group__type.html#gab75d5cdc622d2778bad24e3a8130aab9" title="Update the GPU memory with the current values in op.real and op.imag.">syncDiagonalOp()</a> afterward. </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gaa86572b44755646858d6b0292d53cc15" title="Creates and initialiases a diagonal operator from the Z Pauli Hamiltonian encoded in file with filena...">createDiagonalOpFromPauliHamilFile()</a></li>
<li><a class="el" href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46" title="Overwrites the entire DiagonalOp op with the given real and imag complex elements.">initDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">op</td><td>an existing <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> (e.g. created with <a class="el" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe" title="Creates a DiagonalOp representing a diagonal operator on the full Hilbert space of a Qureg.">createDiagonalOp()</a>) to modify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hamil</td><td>a <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> of equal dimension to <code>op</code>, containing only <code>PAULI_Z</code> and <code>PAULI_I</code> operators </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>hamil</code> has invalid parameters (<code>numQubits</code> &lt;= 0, <code>numSumTerms</code> &lt;= 0)</li>
<li>if <code>op</code> and <code>hamil</code> have unequal dimensions</li>
<li>if <code>hamil</code> contains any operator other than <code>PAULI_Z</code> and <code>PAULI_I</code> </li>
</ul>
</td></tr>
    <tr><td class="paramname">segmentation-fault</td><td><ul>
<li>if either <code>op</code> or <code>hamil</code> have not been already created </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd>
<dd>
Milos Prokop (serial prototype) </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01676">1676</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1676</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1677</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a7de9c41e77487a2939ed076f0cf674e7">validateHamilParams</a>(hamil.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>, hamil.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a>, __func__);</div>
<div class="line"><span class="lineno"> 1678</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ac5bd32bc24176e616a288ae04752fc9c">validateDiagOpInit</a>(op, __func__);</div>
<div class="line"><span class="lineno"> 1679</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a0854ca790899f04a363a97371399e6cb">validateDiagPauliHamil</a>(op, hamil, __func__);</div>
<div class="line"><span class="lineno"> 1680</span>    </div>
<div class="line"><span class="lineno"> 1681</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a81a87bb0f0805c9dfcb691f6cb15a1b5">agnostic_initDiagonalOpFromPauliHamil</a>(op, hamil);</div>
<div class="line"><span class="lineno"> 1682</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_a0854ca790899f04a363a97371399e6cb"><div class="ttname"><a href="QuEST__validation_8c.html#a0854ca790899f04a363a97371399e6cb">validateDiagPauliHamil</a></div><div class="ttdeci">void validateDiagPauliHamil(DiagonalOp op, PauliHamil hamil, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00776">QuEST_validation.c:776</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l01416">agnostic_initDiagonalOpFromPauliHamil()</a>, <a class="el" href="QuEST_8h_source.html#l00289">PauliHamil::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00287">PauliHamil::numSumTerms</a>, <a class="el" href="QuEST__validation_8c_source.html#l00767">validateDiagOpInit()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00776">validateDiagPauliHamil()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00709">validateHamilParams()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00888">TEST_CASE()</a>.</p>

</div>
</div>
<a id="gadbe6701dda1d49168f2f23253e370a7a" name="gadbe6701dda1d49168f2f23253e370a7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadbe6701dda1d49168f2f23253e370a7a">&#9670;&#160;</a></span>initPauliHamil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initPauliHamil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td>
          <td class="paramname"><em>hamil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a> *&#160;</td>
          <td class="paramname"><em>codes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> instance <code>hamil</code> with the given term coefficients and Pauli codes (one for every qubit in every term). </p>
<p >Arguments <code>coeffs</code> and <code>codes</code> encode a weighted sum of Pauli operators, with the same format as other QuEST functions (like <a class="el" href="group__calc.html#ga50ee589fd5ceab52fdd70d0082352b41" title="Computes the expected value of a sum of products of Pauli operators.">calcExpecPauliSum()</a>).</p>
<p >This is useful to set the elements of the <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> in batch. <br  />
For example </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> numQubits = 3;</div>
<div class="line"><span class="keywordtype">int</span> numTerms = 2;</div>
<div class="line"><a class="code hl_struct" href="structPauliHamil.html">PauliHamil</a> hamil = <a class="code hl_function" href="group__type.html#ga35b28710877c462927366fa602e591cb">createPauliHamil</a>(numQubits, numTerms);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// hamil = 0.5 X0 Y1 - 0.5 Z1 X3</span></div>
<div class="line"><a class="code hl_function" href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a">initPauliHamil</a>(hamil, </div>
<div class="line">    (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>[]) {0.5, -0.5}, </div>
<div class="line">    (<span class="keyword">enum</span> <a class="code hl_enumeration" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a>[]) {<a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c">PAULI_X</a>,<a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a2c64a9aaee27f6bcfef894d159e759bd">PAULI_Y</a>,<a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a>, <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a63800f45b01ccc2608f754aee850bf4a">PAULI_I</a>, <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a>, <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a7abac7bb5b71e17382014c443244ad5c">PAULI_X</a>});</div>
<div class="ttc" id="agroup__type_html_gadbe6701dda1d49168f2f23253e370a7a"><div class="ttname"><a href="group__type.html#gadbe6701dda1d49168f2f23253e370a7a">initPauliHamil</a></div><div class="ttdeci">void initPauliHamil(PauliHamil hamil, qreal *coeffs, enum pauliOpType *codes)</div><div class="ttdoc">Initialise PauliHamil instance hamil with the given term coefficients and Pauli codes (one for every ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01630">QuEST.c:1630</a></div></div>
</div><!-- fragment --><p >The initialised <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> can be previewed with <a class="el" href="group__debug.html#gab27234d9ccf440bb5e5d834e8f7e3938" title="Print the PauliHamil to screen.">reportPauliHamil()</a>.</p>
<blockquote class="doxtable">
<p >&zwj;<code>hamil</code> must be already created with <a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a>, or <a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a>. </p>
</blockquote>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__debug.html#gab27234d9ccf440bb5e5d834e8f7e3938" title="Print the PauliHamil to screen.">reportPauliHamil()</a></li>
<li><a class="el" href="group__type.html#ga35b28710877c462927366fa602e591cb" title="Dynamically allocates a Hamiltonian expressed as a real-weighted sum of products of Pauli operators.">createPauliHamil()</a></li>
<li><a class="el" href="group__type.html#gaa77376c5e3518186eb085f37826d6008" title="Creates a PauliHamil instance, a real-weighted sum of products of Pauli operators,...">createPauliHamilFromFile()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">hamil</td><td>an existing <a class="el" href="structPauliHamil.html" title="A Pauli Hamiltonian, expressed as a real-weighted sum of pauli products, and which can hence represen...">PauliHamil</a> instance to be modified </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coeffs</td><td>an array of sum term coefficients, which must have length <code>hamil.numSumTerms</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">codes</td><td>a flat array of Pauli codes, of length <code>hamil.numSumTerms</code>*<code>hamil.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>hamil</code> has invalid parameters (<code>numQubits</code> &lt;= 0, <code>numSumTerms</code> &lt;= 0)</li>
<li>if any code in <code>codes</code> is not a valid Pauli code (<a class="el" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028" title="Codes for specifying Pauli operators.">pauliOpType</a>) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01630">1630</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1630</span>                                                                              {</div>
<div class="line"><span class="lineno"> 1631</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a7de9c41e77487a2939ed076f0cf674e7">validateHamilParams</a>(hamil.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>, hamil.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a>, __func__);</div>
<div class="line"><span class="lineno"> 1632</span>    <a class="code hl_function" href="QuEST__validation_8c.html#aa194ba5f5c6e19c6caa4c715b3dbefcc">validatePauliCodes</a>(codes, hamil.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a>*hamil.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>, __func__);</div>
<div class="line"><span class="lineno"> 1633</span>    </div>
<div class="line"><span class="lineno"> 1634</span>    <span class="keywordtype">int</span> i=0;</div>
<div class="line"><span class="lineno"> 1635</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=0; t&lt;hamil.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a>; t++) {</div>
<div class="line"><span class="lineno"> 1636</span>        hamil.<a class="code hl_variable" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">termCoeffs</a>[t] = coeffs[t];</div>
<div class="line"><span class="lineno"> 1637</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> q=0; q&lt;hamil.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>; q++) {</div>
<div class="line"><span class="lineno"> 1638</span>            hamil.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>[i] = codes[i];</div>
<div class="line"><span class="lineno"> 1639</span>            i++;</div>
<div class="line"><span class="lineno"> 1640</span>        }</div>
<div class="line"><span class="lineno"> 1641</span>    }</div>
<div class="line"><span class="lineno"> 1642</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_aa194ba5f5c6e19c6caa4c715b3dbefcc"><div class="ttname"><a href="QuEST__validation_8c.html#aa194ba5f5c6e19c6caa4c715b3dbefcc">validatePauliCodes</a></div><div class="ttdeci">void validatePauliCodes(enum pauliOpType *pauliCodes, int numPauliCodes, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00651">QuEST_validation.c:651</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00289">PauliHamil::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00287">PauliHamil::numSumTerms</a>, <a class="el" href="QuEST_8h_source.html#l00283">PauliHamil::pauliCodes</a>, <a class="el" href="QuEST_8h_source.html#l00285">PauliHamil::termCoeffs</a>, <a class="el" href="QuEST__validation_8c_source.html#l00709">validateHamilParams()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00651">validatePauliCodes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l00966">TEST_CASE()</a>.</p>

</div>
</div>
<a id="gafabb15a6c1cf49f8ecb67e1f35c77c1e" name="gafabb15a6c1cf49f8ecb67e1f35c77c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafabb15a6c1cf49f8ecb67e1f35c77c1e">&#9670;&#160;</a></span>setDiagonalOpElems()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setDiagonalOpElems </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>imag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numElems</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modifies a subset (starting at index <code>startInd</code>, and ending at index <code>startInd</code> <b>+</b> <code>numElems</code>) of the elements in <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> <code>op</code> with the given complex numbers (passed as <code>real</code> and <code>imag</code> components). </p>
<p >In GPU mode, this updates both the RAM (<code>op.real</code> and <code>op.imag</code>), and the persistent GPU memory.</p>
<p >In distributed mode, this function assumes the subset <code>real</code> and <code>imag</code> exist (at least) on the node containing the ultimately updated elements.<br  />
For example, below is the correct way to modify the full 8 elements of <code>op</code> when split between 2 nodes. </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structDiagonalOp.html">DiagonalOp</a> op = <a class="code hl_function" href="group__type.html#gaebf896dd8d5eeaf9fd896f6cc8e334fe">createDiagonalOp</a>(3, env);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> numElems = 4;</div>
<div class="line"><a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> re[] = {1,2,3,4};</div>
<div class="line"><a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> im[] = {1,2,3,4};</div>
<div class="line"><a class="code hl_function" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e">setDiagonalOpElems</a>(op, 0, re, im, numElems);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// modify re and im to the next set of elements </span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++) {</div>
<div class="line">  re[i] += 4;</div>
<div class="line">  im[i] += 4;</div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e">setDiagonalOpElems</a>(op, 4, re, im, numElems);</div>
<div class="ttc" id="agroup__type_html_gafabb15a6c1cf49f8ecb67e1f35c77c1e"><div class="ttname"><a href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e">setDiagonalOpElems</a></div><div class="ttdeci">void setDiagonalOpElems(DiagonalOp op, long long int startInd, qreal *real, qreal *imag, long long int numElems)</div><div class="ttdoc">Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01669">QuEST.c:1669</a></div></div>
</div><!-- fragment --><p >In this way, one can avoid a single node containing all new elements which might not fit. If more elements are passed than exist on an individual node, each node merely ignores the additional elements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">op</td><td>the <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> to modify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startInd</td><td>the starting index (globally) of the subset of elements to modify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">real</td><td>the real components of the new elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imag</td><td>the imaginary components of the new elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numElems</td><td>the number of new elements (the length of <code>real</code> and <code>imag</code>) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>op</code> was not created</li>
<li>if <code>startInd</code> is an invalid index (&lt;0 or &gt;=<b>pow(2,</b><code>op.numQubits</code><b>)</b>)</li>
<li>if <code>numElems</code> is an invalid number of elements (&lt;=0 or &gt;<b>pow(2,</b><code>op.numQubits</code><b>)</b>)</li>
<li>if there are fewer than <code>numElems</code> elements in <code>op</code> after <code>startInd</code> </li>
</ul>
</td></tr>
    <tr><td class="paramname">segmentation-fault</td><td><ul>
<li>if either <code>real</code> or <code>imag</code> have fewer elements than <code>numElems</code> </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01669">1669</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1669</span>                                                                                                                 {</div>
<div class="line"><span class="lineno"> 1670</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ac5bd32bc24176e616a288ae04752fc9c">validateDiagOpInit</a>(op, __func__);</div>
<div class="line"><span class="lineno"> 1671</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a1c52594c03d2c136993b27f4dd315c11">validateNumElems</a>(op, startInd, numElems, __func__);</div>
<div class="line"><span class="lineno"> 1672</span>    </div>
<div class="line"><span class="lineno"> 1673</span>    <a class="code hl_function" href="QuEST__internal_8h.html#ab58d6d599c7a729255b1f8eeded663f3">agnostic_setDiagonalOpElems</a>(op, startInd, real, imag, numElems);</div>
<div class="line"><span class="lineno"> 1674</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_a1c52594c03d2c136993b27f4dd315c11"><div class="ttname"><a href="QuEST__validation_8c.html#a1c52594c03d2c136993b27f4dd315c11">validateNumElems</a></div><div class="ttdeci">void validateNumElems(DiagonalOp op, long long int startInd, long long int numElems, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l00445">QuEST_validation.c:445</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l04259">agnostic_setDiagonalOpElems()</a>, <a class="el" href="QuEST__validation_8c_source.html#l00767">validateDiagOpInit()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00445">validateNumElems()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__data__structures_8cpp_source.html#l01032">TEST_CASE()</a>.</p>

</div>
</div>
<a id="gab75d5cdc622d2778bad24e3a8130aab9" name="gab75d5cdc622d2778bad24e3a8130aab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab75d5cdc622d2778bad24e3a8130aab9">&#9670;&#160;</a></span>syncDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the GPU memory with the current values in <code>op.real</code> and <code>op.imag</code>. </p>
<p >This is required after making manual changes to <code>op</code>, but is not required after functions <a class="el" href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46" title="Overwrites the entire DiagonalOp op with the given real and imag complex elements.">initDiagonalOp()</a> and <a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a>.</p>
<p >This function has no effect in other modes besides GPU mode.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a></li>
<li><a class="el" href="group__type.html#ga12a6c59ebbfba8bdb9453a4138027d46" title="Overwrites the entire DiagonalOp op with the given real and imag complex elements.">initDiagonalOp()</a></li>
<li><a class="el" href="group__type.html#gafabb15a6c1cf49f8ecb67e1f35c77c1e" title="Modifies a subset (starting at index startInd, and ending at index startInd + numElems) of the elemen...">setDiagonalOpElems()</a></li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">op</td><td>the <a class="el" href="structDiagonalOp.html" title="Represents a diagonal complex operator on the full Hilbert state of a Qureg.">DiagonalOp</a> to synch to GPU </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="group__debug.html#ga51a64b05d31ef9bcf6a63ce26c0092db" title="An internal function called when invalid arguments are passed to a QuEST API call,...">invalidQuESTInputError()</a></td><td><ul>
<li>if <code>op</code> was not created </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Tyson Jones </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01657">1657</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1657</span>                                   {</div>
<div class="line"><span class="lineno"> 1658</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ac5bd32bc24176e616a288ae04752fc9c">validateDiagOpInit</a>(op, __func__);</div>
<div class="line"><span class="lineno"> 1659</span>    </div>
<div class="line"><span class="lineno"> 1660</span>    <a class="code hl_function" href="QuEST__internal_8h.html#a1e8f917ab42d38d8c37ba6816b24f2f5">agnostic_syncDiagonalOp</a>(op);</div>
<div class="line"><span class="lineno"> 1661</span>}</div>
<div class="ttc" id="aQuEST__internal_8h_html_a1e8f917ab42d38d8c37ba6816b24f2f5"><div class="ttname"><a href="QuEST__internal_8h.html#a1e8f917ab42d38d8c37ba6816b24f2f5">agnostic_syncDiagonalOp</a></div><div class="ttdeci">void agnostic_syncDiagonalOp(DiagonalOp op)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01412">QuEST_cpu.c:1412</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l01412">agnostic_syncDiagonalOp()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00767">validateDiagOpInit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__calculations_8cpp_source.html#l00111">TEST_CASE()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
</body>
        <script type="text/javascript" src="boot.js"></script>
</html>
